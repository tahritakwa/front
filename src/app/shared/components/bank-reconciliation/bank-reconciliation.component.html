<div class="col-lg-12 col-sm-12 col-md-12 col-xs-12">

  <div class="row">
    <div class="col-lg-12 col-sm-12 col-md-12">
      <div class="form-group row" style="margin-bottom: 20px; margin-top: 30px;">
        <div class="col-xl-5 col-lg-5 col-md-5 col-sm-12 col-sx-12">
          <input type="checkbox" class="k-checkbox" id="unreconciledRegulations"
                 [(ngModel)]="unreconciledRegulationsValue" (change)="checkBoxValueChange()">
          <label class="k-checkbox-label" for="unreconciledRegulations">
            {{'UNRECONCILED_REGULATIONS' | translate}}</label>
        </div>
        <div class="col-xl-7 col-lg-7 col-md-7 col-sm-12 col-sx-12">
          <input type="checkbox" class="k-checkbox" id="reconciledRegulations" [(ngModel)]="reconciledRegulationsValue"
                 (change)="checkBoxValueChange()">
          <label class="k-checkbox-label" for="reconciledRegulations">
            {{'RECONCILED_REGULATIONS' | translate}}</label>
        </div>
      </div>
      <div class="form-horizontal" [formGroup]="reconciledFormGroup" style="margin-bottom: 30px; margin-top: 30px;">
        <div class="form-group row">
          <div class="col-xl-5 col-lg-5 col-md-5 col-sm-12 col-sx-12">
            <label class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-sx-12">{{'BANK_RECEIPT_DATE' | translate }}
              <span class="required">*</span>
            </label>
            <kendo-datepicker [format]="dateFormat" formControlName="ReconciliationDate" class="form-control"
                              [ngClass]="{ 'has-error': (reconciledFormGroup.controls.ReconciliationDate.touched ||
                reconciledFormGroup.controls.ReconciliationDate.dirty) && !reconciledFormGroup.controls.ReconciliationDate.valid }">
              <kendo-datepicker-messages today="{{ 'TODAY' | translate}}"
                                         toggle="{{ 'CALENDAR.MENU_TITLE' | translate}}">
              </kendo-datepicker-messages>
            </kendo-datepicker>
            <app-control-messages [control]="reconciledFormGroup.controls.ReconciliationDate"
                                  class="error-msg messages text-left text-danger">
            </app-control-messages>
          </div>
          <div class="col-xl-7 col-lg-7 col-md-7 col-sm-12 col-sx-12">
            <label class="col-xl-12 col-lg-12 col-md-12 col-sm-12 col-sx-12">
              {{'BANK_RECEIPT_FILE' | translate }}
            </label>
            <app-upload-file [showLabel]="false" [fileNameCharactersToShow]="20"
                             [fileToUpload]="BankReceiptAttachmentFile">
            </app-upload-file>
          </div>
        </div>
      </div>
      <div class="form-group row" style="margin-top: -2em; margin-bottom: 2em;">
        <div class="col-xl-3 col-lg-3 col-md-3 col-sm-12 col-sx-12"
             *ngIf="(unreconciledRegulationsValue && !reconciledRegulationsValue) && hasValidateRegulationsPermission">
          <button class="btn btn-sm btn-save" (click)="validate()" style="margin-top: 2.5em;">
            <i class="fa fa-check fa-lg"></i> {{'VALIDATE_REGULATIONS'|translate}}
          </button>
        </div>
      </div>
    </div>
  </div>

  <kendo-grid [data]="gridSettings.gridData" [pageSize]="gridSettings.state.take" [skip]="gridSettings.state.skip"
              [sort]="gridSettings.state.sort" [filter]="gridSettings.state.filter" (dataStateChange)="dataStateChange($event)"
              [sortable]="true" [pageable]="pagerSettings" [filterable]="true" [reorderable]="true"
              [selectable]="selectableSettings" [kendoGridSelectBy]="'Id'" [selectedKeys]="selectedSettlementIds"
              (selectedKeysChange)="onSelectedKeysChange()">

    <!--CheckBox field-->
    <kendo-grid-checkbox-column [width]="70">
      <ng-template kendoGridHeaderTemplate let-dataItem>
        <input class="k-checkbox" id="selectAllCheckboxId" kendoGridSelectAllCheckbox [state]="selectAllState"
               (selectAllChange)="onSelectAllChange($event)">
        <label class="k-checkbox-label" for="selectAllCheckboxId"></label>
      </ng-template>
    </kendo-grid-checkbox-column>
    <!-- End checkBox field -->
    <!-- Begin Code  -->
    <kendo-grid-column [field]="gridSettings.columnsConfig[0].field"
                       [title]="gridSettings.columnsConfig[0].title | translate" [width]="200"
                       [filter]="gridSettings.columnsConfig[0].filter" [filterable]="gridSettings.columnsConfig[0].filterable">
      <ng-template kendoGridHeaderTemplate>
        <span tooltip="{{gridSettings.columnsConfig[0].tooltip|translate}}"
              theme="light">{{gridSettings.columnsConfig[0].title|translate}}</span>
      </ng-template>
    </kendo-grid-column>
    <!-- End Code  -->
    <!-- Begin  SettlementDate -->
    <kendo-grid-column [field]="gridSettings.columnsConfig[1].field"
                       [title]="gridSettings.columnsConfig[1].title | translate" [width]="200" filter='date'
                       [filterable]="gridSettings.columnsConfig[1].filterable">
      <ng-template kendoGridHeaderTemplate>
        <span tooltip="{{gridSettings.columnsConfig[1].tooltip|translate}}"
              theme="light">{{gridSettings.columnsConfig[1].title|translate}}</span>
      </ng-template>
      <ng-template kendoGridCellTemplate let-dataItem="dataItem">
        {{dataItem.SettlementDate | date: dateFormat}}
      </ng-template>
    </kendo-grid-column>
    <!-- End  SettlementDate -->
    <!-- Begin  Reference of paymentSlip -->
    <kendo-grid-column [field]="gridSettings.columnsConfig[2].field"
                       [title]="gridSettings.columnsConfig[2].title | translate" [width]="210"
                       [filter]="gridSettings.columnsConfig[2].filter" [filterable]="gridSettings.columnsConfig[2].filterable">
      <ng-template kendoGridHeaderTemplate>
        <span tooltip="{{gridSettings.columnsConfig[2].tooltip|translate}}"
              theme="light">{{gridSettings.columnsConfig[2].title|translate}}</span>
      </ng-template>
      <ng-template kendoGridCellTemplate let-dataItem="dataItem">
        {{ dataItem.PaymentSlipReference }}
      </ng-template>
    </kendo-grid-column>
    <!-- End Reference of paymentSlip -->
    <!-- Begin  ReconciliationDate -->
    <kendo-grid-column [field]="gridSettings.columnsConfig[3].field"
                       [title]="gridSettings.columnsConfig[3].title | translate" [width]="210" filter='date'
                       [filterable]="gridSettings.columnsConfig[3].filterable">
      <ng-template kendoGridHeaderTemplate>
        <span tooltip="{{gridSettings.columnsConfig[3].tooltip|translate}}"
              theme="light">{{gridSettings.columnsConfig[3].title|translate}}</span>
      </ng-template>
      <ng-template kendoGridCellTemplate let-dataItem="dataItem">
        <div *ngIf="dataItem.IdPaymentStatus === paymentStatusEnumerator.RemittanceSlip">
          ---
        </div>
        <div *ngIf="dataItem.IdPaymentStatus === paymentStatusEnumerator.Cashed">
          {{dataItem.PaymentSlipReconciliationDate | date: dateFormat}}
        </div>
      </ng-template>
    </kendo-grid-column>
    <!-- End  ReconciliationDate -->
    <!-- Begin  supplier settlementAmountWithCurrency  (debit)-->
    <kendo-grid-column [field]="gridSettings.columnsConfig[4].field"
                       [title]="gridSettings.columnsConfig[4].title | translate" [width]="200" filter='numeric'
                       [filterable]="gridSettings.columnsConfig[4].filterable" [style]='{"font-family": "Arial, Helvetica, serif",
          "color": "#505253",
          "text-align":"right",
          "padding-right": "5%"}'>
      <ng-template kendoGridHeaderTemplate>
        <span tooltip="{{gridSettings.columnsConfig[4].tooltip|translate}}"
              theme="light">{{gridSettings.columnsConfig[4].title|translate}}</span>
      </ng-template>
      <ng-template kendoGridCellTemplate let-dataItem="dataItem">
        <span *ngIf="dataItem.IdTypeTiers == tiersTypeEnum.Supplier">
          {{dataItem.AmountWithCurrency.toLocaleString(language,{minimumFractionDigits: dataItem.Precision,
          style: 'currency', currency: dataItem.CurrencyCode, currencyDisplay:'code'})}}
        </span>
        <span *ngIf="dataItem.IdTypeTiers == tiersTypeEnum.Customer">
          ---
        </span>
      </ng-template>
    </kendo-grid-column>
    <!-- End  supplier settlementAmountWithCurrency  (debit)-->
    <!-- Begin  tiers settlementAmountWithCurrency  (credit)-->
    <kendo-grid-column [field]="gridSettings.columnsConfig[5].field"
                       [title]="gridSettings.columnsConfig[5].title | translate" [width]="200" filter='numeric'
                       [filterable]="gridSettings.columnsConfig[5].filterable" [style]='{"font-family": "Arial, Helvetica, serif",
          "color": "#505253",
          "text-align":"right",
          "padding-right": "5%"}'>
      <ng-template kendoGridHeaderTemplate>
        <span tooltip="{{gridSettings.columnsConfig[5].tooltip|translate}}"
              theme="light">{{gridSettings.columnsConfig[5].title|translate}}</span>
      </ng-template>
      <ng-template kendoGridCellTemplate let-dataItem="dataItem">
        <span *ngIf="dataItem.IdTypeTiers == tiersTypeEnum.Customer">
          {{dataItem.AmountWithCurrency.toLocaleString(language,{minimumFractionDigits: dataItem.Precision,
          style: 'currency', currency: dataItem.CurrencyCode, currencyDisplay:'code'})}}
        </span>
        <span *ngIf="dataItem.IdTypeTiers == tiersTypeEnum.Supplier">
          ---
        </span>
      </ng-template>
    </kendo-grid-column>
    <!-- End  tiers settlementAmountWithCurrency  (credit)-->
    <!-- Begin  Status -->
    <kendo-grid-column [field]="gridSettings.columnsConfig[6].field"
                       [title]="gridSettings.columnsConfig[6].title | translate" [width]="200"
                       [filterable]="gridSettings.columnsConfig[6].filterable">
      <ng-template kendoGridHeaderTemplate>
        <span tooltip="{{gridSettings.columnsConfig[6].tooltip|translate}}"
              theme="light">{{gridSettings.columnsConfig[6].title|translate}}</span>
      </ng-template>
      <ng-template kendoGridFilterCellTemplate let-filter let-column="column">
        <app-payment-status-dropdown [group]="reconciledFormGroup" (selectedValue)="paymentMethodFilterChange($event)">
        </app-payment-status-dropdown>
      </ng-template>
      <ng-template kendoGridCellTemplate let-dataItem="dataItem">
        <div *ngIf="dataItem.IdPaymentStatus === paymentStatusEnumerator.Settled">
          <span class="badge badge-warning" style="color: #ffffff;">
            {{'SETTLED' |translate }}
          </span>
        </div>

        <div *ngIf="dataItem.IdPaymentStatus === paymentStatusEnumerator.InBank">
          <span class="badge badge-primary" style="color: #ffffff;">
            {{'IN_BANK' |translate }}
          </span>
        </div>

        <div *ngIf="dataItem.IdPaymentStatus === paymentStatusEnumerator.Cashed">
          <span class="badge badge-success" style="color: #ffffff;">
            {{'CASHED' |translate }}
          </span>
        </div>
      </ng-template>
    </kendo-grid-column>
    <!-- End  Status -->
  </kendo-grid>
</div>

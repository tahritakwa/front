<app-spinner *ngIf="spinner" class="spinner"></app-spinner>
<div class="header-current-fiscal-year">
  <app-accounting-reporting-menu-editions [currentFiscalYearId]="currentFiscalYear.id">
  </app-accounting-reporting-menu-editions>
</div>
<div class="card">
  <div class="d-flex flex-row-reverse bd-highlight m-3">
    <app-current-fiscal-year-dropdown [currentFiscalYearId]="currentFiscalYear.id"></app-current-fiscal-year-dropdown>
  </div>
  <form class="form-horizontal" [formGroup]="trialBalanceFilterFormGroup">

    <div class="card-body">
      <div class="container-fluid">

        <div class="col-lg-12 col-sm-12 col-md-12">
          <div class="form-group row mb-0">
            <div class="col-lg-12 col-sm-12 col-md-12 ">
              <div class="form-group row mb-0">
                <div class="col-sm-12 col-md-6 col-lg-3">
                  <div class="row">
                    <label class="col-lg-12 col-md-12 col-sm-12">
                      {{'START_DATE'|translate}}<span class="required">*</span>
                    </label>
                    <div class="col-lg-12 col-md-12  col-sm-12">
                      <kendo-datepicker [format]="formatDate" formControlName="startDate" class="form-control"
                                        formatPlaceholder="formatDate" [min]="startDate" [max]="endDate"
                                        [ngModel]="startDate">
                        <kendo-datepicker-messages today="{{ 'TODAY' | translate}}"
                                                   toggle="{{ 'CALENDAR.MENU_TITLE' | translate}}">
                        </kendo-datepicker-messages>
                      </kendo-datepicker>
                      <app-control-messages [control]="trialBalanceFilterFormGroup.controls.startDate"
                                            class="error-msg messages text-left text-danger"></app-control-messages>
                    </div>
                  </div>
                </div>
                <div class="col-sm-12 col-md-6 col-lg-3">
                  <div class="row">
                    <label class="col-lg-12 col-md-12 col-sm-12">{{'END_DATE'|translate}}<span
                      class="required">*</span></label>

                    <div class="col-lg-12 col-md-12  col-sm-12">
                      <kendo-datepicker [format]="formatDate" formControlName="endDate" class="form-control"
                                        formatPlaceholder="formatDate" [min]="startDate" [max]="endDate"
                                        [ngModel]="endDate">
                        <kendo-datepicker-messages today="{{ 'TODAY' | translate}}"
                                                   toggle="{{ 'CALENDAR.MENU_TITLE' | translate}}">
                        </kendo-datepicker-messages>
                      </kendo-datepicker>
                      <app-control-messages [control]="trialBalanceFilterFormGroup.controls.endDate"
                                            class="error-msg messages text-left text-danger"></app-control-messages>
                    </div>
                  </div>
                </div>
                <app-filter-by-account class="col-lg-6 col-sm-12 col-md-12"
                                       [FilterFormGroup]="trialBalanceFilterFormGroup"></app-filter-by-account>
              </div>
            </div>
          </div>
        </div>

        <div class="row d-flex flex-row-reverse">
          <div class="col-lg-12 d-flex justify-content-between">
            <div>
              <div class="col-lg-12 col-sm-12 col-md-12 input-group">
                <input type="checkbox" id="edit-prev" class="input-checkbox100"
                       (click)='changeProvisionalEdition()'/>
                <label class="label-checkbox100" for="edit-prev">{{'PROVISIONAL_EDITION'|translate}}</label>
              </div>
            </div>
            <div class="mt-4 mb-3">
              <button class="btn btn-sm btn-search mr-2" type="button"
                      (click)="onSearch()">
                <i class="fa fa-search fa-lg" aria-hidden="true"></i> {{'SEARCH'|translate}}
              </button>

              <button class="btn btn-sm btn-primary dropdown-toggle" type="button"
                      data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                      *ngIf="this.authService.hasAuthority(AccountingPermissions.PRINT_EDITIONS_REPORTS)">
                <i class="fa fa-print"></i>
              </button>

              <div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
                <a class="dropdown-item" (click)="onClickPrintByJasper()">PDF</a>
                <a class="dropdown-item" (click)="onClickPrintExcel()">Excel</a>
              </div>
            </div>
          </div>
        </div>
      </div>

      <kendo-grid [data]="gridSettings.gridData" [pageSize]="gridSettings.state.take" [skip]="gridSettings.state.skip"
                  [sortable]="true" filterable="menu" [reorderable]="true" [columnMenu]="true"
                  (dataStateChange)="dataStateChange($event)" (pageChange)="onPageChange()" [pageable]="pagerSettings"
                  [sort]="gridSettings.state.sort" [filter]="gridSettings.state.filter" [rowClass]="rowClassCallback">

        <kendo-grid-column-group [title]="'ACCOUNT' | translate" [width]="350" [locked]="false" [columnMenu]="false">
          <kendo-grid-column [footerStyle]="{'font-weight': 'bolder'}" [field]="gridSettings.columnsConfig[0].field"
                             [title]="gridSettings.columnsConfig[0].title | translate" width="100" [columnMenu]="false">
            <ng-template kendoGridHeaderTemplate>
              <span tooltip="{{gridSettings.columnsConfig[0].tooltip|translate}}"
                    theme="light">{{gridSettings.columnsConfig[0].title|translate}}</span>
            </ng-template>
          </kendo-grid-column>
          <kendo-grid-column [footerStyle]="{'font-weight': 'bolder'}" [field]="gridSettings.columnsConfig[1].field"
                             [title]="gridSettings.columnsConfig[1].title | translate" width="250" [columnMenu]="false">
            <ng-template kendoGridHeaderTemplate>
              <span tooltip="{{gridSettings.columnsConfig[1].tooltip|translate}}"
                    theme="light">{{gridSettings.columnsConfig[1].title|translate}}</span>
            </ng-template>
            <ng-template kendoGridFooterTemplate let-column let-columnIndex="columnIndex">
              <div class="total-class">{{'TOTAL_TRIAL_BALANCE'|translate}}</div>
            </ng-template>
          </kendo-grid-column>

        </kendo-grid-column-group>

        <kendo-grid-column-group [title]="'INITIAL_BALANCE' | translate" [width]="300" [locked]="false"
                                 [columnMenu]="false">
          <kendo-grid-column [footerStyle]="{'font-weight': 'bolder'}" [field]="gridSettings.columnsConfig[2].field"
                             [title]="gridSettings.columnsConfig[2].title| translate" [locked]="false" width="150"
                             [format]="formatNumberOptions" class="amount-field" [columnMenu]="false">
            <ng-template kendoGridHeaderTemplate>
              <span tooltip="{{gridSettings.columnsConfig[2].tooltip|translate}}"
                    theme="light">{{gridSettings.columnsConfig[2].title|translate}}</span>
            </ng-template>
            <ng-template kendoGridFooterTemplate>
              <kendo-numerictextbox [readonly]="true" [format]="formatNumberOptions"
                                    [value]="trialBalanceDebitInitialTotal">
              </kendo-numerictextbox>
            </ng-template>
          </kendo-grid-column>
          <kendo-grid-column [footerStyle]="{'font-weight': 'bolder'}" [field]="gridSettings.columnsConfig[3].field"
                             [title]="gridSettings.columnsConfig[3].title | translate" [locked]="false" width="150"
                             [format]="formatNumberOptions" class="amount-field" [columnMenu]="false">
            <ng-template kendoGridHeaderTemplate>
              <span tooltip="{{gridSettings.columnsConfig[3].tooltip|translate}}"
                    theme="light">{{gridSettings.columnsConfig[3].title|translate}}</span>
            </ng-template>
            <ng-template kendoGridFooterTemplate>
              <kendo-numerictextbox [readonly]="true" [format]="formatNumberOptions"
                                    [value]="trialBalanceCreditInitialTotal">
              </kendo-numerictextbox>
            </ng-template>
          </kendo-grid-column>

        </kendo-grid-column-group>

        <kendo-grid-column-group [title]="'CURRENT_BALANCE' | translate" [width]="300" [locked]="false"
                                 [columnMenu]="false">
          <kendo-grid-column [footerStyle]="{'font-weight': 'bolder'}" [field]="gridSettings.columnsConfig[4].field"
                             [title]="gridSettings.columnsConfig[4].title | translate" [locked]="false" width="150"
                             [format]="formatNumberOptions" class="amount-field" [columnMenu]="false">
            <ng-template kendoGridHeaderTemplate>
              <span tooltip="{{gridSettings.columnsConfig[4].tooltip|translate}}"
                    theme="light">{{gridSettings.columnsConfig[4].title|translate}}</span>
            </ng-template>
            <ng-template kendoGridFooterTemplate>
              <kendo-numerictextbox [readonly]="true" [format]="formatNumberOptions"
                                    [value]="trialBalanceDebitCurrentTotal">
              </kendo-numerictextbox>
            </ng-template>
          </kendo-grid-column>
          <kendo-grid-column [footerStyle]="{'font-weight': 'bolder'}" [field]="gridSettings.columnsConfig[5].field"
                             [title]="gridSettings.columnsConfig[5].title | translate" [locked]="false" width="150"
                             [format]="formatNumberOptions" class="amount-field" [columnMenu]="false">
            <ng-template kendoGridHeaderTemplate>
              <span tooltip="{{gridSettings.columnsConfig[5].tooltip|translate}}"
                    theme="light">{{gridSettings.columnsConfig[5].title|translate}}</span>
            </ng-template>
            <ng-template kendoGridFooterTemplate>
              <kendo-numerictextbox [readonly]="true" [format]="formatNumberOptions"
                                    [value]="trialBalanceCreditCurrentTotal">
              </kendo-numerictextbox>
            </ng-template>
          </kendo-grid-column>

        </kendo-grid-column-group>

        <kendo-grid-column-group [title]="'ACCUMULATED_BALANCE' | translate" [width]="300" [locked]="false"
                                 [columnMenu]="false">
          <kendo-grid-column [footerStyle]="{'font-weight': 'bolder'}" [field]="gridSettings.columnsConfig[6].field"
                             [title]="gridSettings.columnsConfig[6].title | translate" [locked]="false" width="150"
                             [format]="formatNumberOptions" class="amount-field" [columnMenu]="false">
            <ng-template kendoGridHeaderTemplate>
              <span tooltip="{{gridSettings.columnsConfig[6].tooltip|translate}}"
                    theme="light">{{gridSettings.columnsConfig[6].title|translate}}</span>
            </ng-template>
            <ng-template kendoGridFooterTemplate>
              <kendo-numerictextbox [readonly]="true" [format]="formatNumberOptions"
                                    [value]="trialBalanceAccumulatedDebit">
              </kendo-numerictextbox>
            </ng-template>
          </kendo-grid-column>
          <kendo-grid-column [footerStyle]="{'font-weight': 'bolder'}" [field]="gridSettings.columnsConfig[7].field"
                             [title]="gridSettings.columnsConfig[7].title | translate" [locked]="false" width="150"
                             [format]="formatNumberOptions" class="amount-field" [columnMenu]="false">
            <ng-template kendoGridHeaderTemplate>
              <span tooltip="{{gridSettings.columnsConfig[7].tooltip|translate}}"
                    theme="light">{{gridSettings.columnsConfig[7].title|translate}}</span>
            </ng-template>
            <ng-template kendoGridFooterTemplate>
              <kendo-numerictextbox [readonly]="true" [format]="formatNumberOptions"
                                    [value]="trialBalanceAccumulatedCredit">
              </kendo-numerictextbox>
            </ng-template>
          </kendo-grid-column>
        </kendo-grid-column-group>

        <kendo-grid-column-group [title]="'BALANCE' | translate" [width]="300" [locked]="false" [columnMenu]="true">
          <kendo-grid-column [footerStyle]="{'font-weight': 'bolder'}" [field]="gridSettings.columnsConfig[8].field"
                             [title]="gridSettings.columnsConfig[6].title | translate" [locked]="false" width="150"
                             [format]="formatNumberOptions" class="amount-field" [columnMenu]="false">
            <ng-template kendoGridHeaderTemplate>
              <span tooltip="{{gridSettings.columnsConfig[6].tooltip|translate}}"
                    theme="light">{{gridSettings.columnsConfig[6].title|translate}}</span>
            </ng-template>
            <ng-template kendoGridFooterTemplate>
              <kendo-numerictextbox [readonly]="true" [format]="formatNumberOptions" [value]="trialBalanceDebit">
              </kendo-numerictextbox>
            </ng-template>
          </kendo-grid-column>
          <kendo-grid-column [footerStyle]="{'font-weight': 'bolder'}" [field]="gridSettings.columnsConfig[9].field"
                             [title]="gridSettings.columnsConfig[7].title | translate" [locked]="false" width="150"
                             [format]="formatNumberOptions" class="amount-field" [columnMenu]="true">
            <ng-template kendoGridHeaderTemplate>
              <span tooltip="{{gridSettings.columnsConfig[7].tooltip|translate}}"
                    theme="light">{{gridSettings.columnsConfig[7].title|translate}}</span>
            </ng-template>
            <ng-template kendoGridFooterTemplate>
              <kendo-numerictextbox [readonly]="true" [format]="formatNumberOptions" [value]="trialBalanceCredit">
              </kendo-numerictextbox>
            </ng-template>
          </kendo-grid-column>
        </kendo-grid-column-group>
        <kendo-grid-messages pagerItems="{{'ELEMENTS_PAGER'|translate}}"
                             pagerItemsPerPage="{{'ELEMENTS_PER_PAGE_PAGER'|translate}} - {{currencyCode}}">
        </kendo-grid-messages>
      </kendo-grid>
    </div>
  </form>
</div>

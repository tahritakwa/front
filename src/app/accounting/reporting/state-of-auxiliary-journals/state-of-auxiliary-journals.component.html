<app-spinner *ngIf="isStateOfAuxiliaryJournalBeingLoaded || isReportBeingPrinted" class="spinner"></app-spinner>
<div class="header-current-fiscal-year">
  <app-accounting-reporting-menu-journals [currentFiscalYearId]="currentFiscalYear.id">
  </app-accounting-reporting-menu-journals>
</div>
<div class="card">
  <div class="d-flex flex-row-reverse bd-highlight m-3">
    <app-current-fiscal-year-dropdown [currentFiscalYearId]="currentFiscalYear.id"></app-current-fiscal-year-dropdown>
  </div>
  <form class="form-horizontal" [formGroup]="stateOfAuxiliaryJournalsFilterFormGroup">
    <div class="card-body">
      <!--filter block-->
      <div class="form-group row">
        <div class="col-sm-12 col-md-12 col-lg-12">
          <div class="form-group row mb-0">
            <div class="col-lg-4 col-md-4 col-sm-4">
              <div class="form-group row mb-0">
                <label class="col-lg-12 col-md-12 col-sm-12"> {{'START_DATE'|translate}}<span
                  class="required">*</span></label>
                <div class="col-lg-12 col-md-12 col-sm-12">
                  <kendo-datepicker [format]="formatDate" formControlName="startDate" class="form-control"
                                    [min]="startDate" [max]="endDate">
                    <kendo-datepicker-messages today="{{ 'TODAY' | translate}}" toggle="Cambiar calendario">
                    </kendo-datepicker-messages>
                  </kendo-datepicker>
                  <app-control-messages [control]="stateOfAuxiliaryJournalsFilterFormGroup.controls.startDate"
                                        class="error-msg messages text-left text-danger"></app-control-messages>
                </div>
              </div>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4">
              <div class="row">
                <label
                  class="col-lg-12 col-md-12 col-sm-12">{{'END_DATE'|translate}}<span class="required">*</span></label>
                <div class="col-lg-12 col-md-12 col-sm-12">
                  <kendo-datepicker [format]="formatDate" formControlName="endDate" class="form-control"
                                    [min]="startDate" [max]="endDate">
                    <kendo-datepicker-messages today="{{ 'TODAY' | translate}}" toggle="Cambiar calendario">
                    </kendo-datepicker-messages>
                  </kendo-datepicker>
                  <app-control-messages [control]="stateOfAuxiliaryJournalsFilterFormGroup.controls.endDate"
                                        class="error-msg messages text-left text-danger"></app-control-messages>
                </div>
              </div>
            </div>
            <div class="col-lg-4 col-md-4 col-sm-4">
              <div class="row">
                <label class="col-lg-12 col-md-12 col-sm-12"> {{'JOURNAL'|translate}}</label>
                <div class="col-lg-12 col-md-12 col-sm-12">
                  <ng-multiselect-dropdown formControlName="valuesIdJournal" [placeholder]="placeholder|translate"
                                           [data]="journalList" [disabled]="false" [settings]="dropdownSettings"
                                           [(ngModel)]="journalListSelected" (click)="isMultiSelectTouched = true">
                  </ng-multiselect-dropdown>
                </div>
              </div>
            </div>
          </div>
      </div>
    </div>
      <div class="form-group row d-flex flex-row-reverse">
        <div class="col-lg-12 d-flex justify-content-between">
          <div>
            <input type="checkbox" id="prev-check-box" class="input-checkbox100"
                   (click)='changeProvisionalEdition()'/>
            <label class="label-checkbox100" for="prev-check-box"> {{'PROVISIONAL_EDITION'|translate}}</label>
          </div>
          <div class="mt-4">
            <button class="btn btn-sm btn-search mr-2" type="button"
                    aria-hidden="true" (click)="onSearch()"
                    *ngIf="this.authService.hasAuthority(AccountingPermissions.VIEW_JOURNALS_REPORTS)">
              <i class="fa fa-search fa"></i> <span>{{'SEARCH'|translate}}</span>
            </button>

            <button class="btn btn-sm btn-primary dropdown-toggle" type="button"
                    data-toggle="dropdown" aria-haspopup="true" aria-expanded="false"
                    *ngIf="this.authService.hasAuthority(AccountingPermissions.PRINT_JOURNALS_REPORTS)">
              <i class="fa fa-print"></i>
            </button>
            <div class="dropdown-menu" aria-labelledby="btnGroupDrop1">
              <a class="dropdown-item" (click)="onClickPrintByJasper()">PDF</a>
              <a class="dropdown-item" (click)="onClickPrintExcel()">Excel</a>
            </div>
          </div>
        </div>
      </div>
    <!--grid block-->
    <div *ngIf="this.authService.hasAuthority(AccountingPermissions.VIEW_JOURNALS_REPORTS)">
    <kendo-grid [data]="stateOfJournalsView | async" [pageSize]="gridSettings.state.take"
                [skip]="gridSettings.state.skip" [sortable]="true" [pageable]="pagerSettings" [navigable]="true"
                (dataStateChange)="dataStateChange($event)" [columnMenu]="true" (pageChange)="onPageChange()"
                class="bulk-table">

      <kendo-grid-column [footerStyle]="{'font-weight': 'bolder'}" field="codeJournal" [columnMenu]="false"
                         [headerStyle]="{'padding' : '0.75rem 0'}" [width]="150" [title]="'CODE_JOURNAL'|translate">
        <ng-template kendoGridHeaderTemplate>
          <span tooltip="{{'CODE_JOURNAL'|translate}}" theme="light">{{'CODE_JOURNAL'|translate}}</span>
        </ng-template>
      </kendo-grid-column>

      <kendo-grid-column [footerStyle]="{'font-weight': 'bolder'}" field="labelJournal" [title]="'LABEL'|translate"
                         [width]="350" [headerStyle]="{'padding' : '0.75rem 0'}" [columnMenu]="false">
        <ng-template kendoGridHeaderTemplate>
          <span tooltip="{{'LABEL'|translate}}" theme="light">{{'LABEL'|translate}}</span>
        </ng-template>
        <ng-template kendoGridFooterTemplate>
          <div class="total-class"> {{'TOTAL_AUXILIARY_JOURNALS'|translate}}</div>
        </ng-template>
      </kendo-grid-column>

      <kendo-grid-column [style]="{'text-align': 'right'}"
                         [footerStyle]="{'font-weight': 'bolder','text-align': 'right'}" field="totalDebit"
                         width="100px"
                         [title]="'DEBIT'|translate" [format]="formatNumberOptions" [columnMenu]="false">
        <ng-template kendoGridHeaderTemplate>
          <span tooltip="{{'DEBIT'|translate}}" theme="light">{{'DEBIT'|translate}}</span>
        </ng-template>
        <ng-template kendoGridFooterTemplate>
          <kendo-numerictextbox [readonly]="true" [format]="formatNumberOptions" [value]="totalDebit">
          </kendo-numerictextbox>
        </ng-template>
      </kendo-grid-column>

      <kendo-grid-column [style]="{'text-align': 'right'}"
                         [footerStyle]="{'font-weight': 'bolder','text-align': 'right'}" field="totalCredit"
                         width="100px"
                         [title]="'CREDIT'|translate" [format]="formatNumberOptions" [columnMenu]="true">
        <ng-template kendoGridHeaderTemplate>
          <span tooltip="{{'CREDIT'|translate}}" theme="light">{{'CREDIT'|translate}}</span>
        </ng-template>
        <ng-template kendoGridFooterTemplate>
          <kendo-numerictextbox [readonly]="true" [format]="formatNumberOptions" [value]="totalCredit">
          </kendo-numerictextbox>
        </ng-template>
      </kendo-grid-column>
      <div *kendoGridDetailTemplate="let dataItem">
        <app-auxiliary-journal-details [auxiliaryJournal]="dataItem">
        </app-auxiliary-journal-details>
      </div>

      <kendo-grid-messages pagerItems="{{'ELEMENTS_PAGER'|translate}}"
                           pagerItemsPerPage="{{'ELEMENTS_PER_PAGE_PAGER'|translate}} - {{currencyCode}}">
      </kendo-grid-messages>

    </kendo-grid>
    </div>
</div>
</form>
</div>

<div class="row">
  <div class="col-sm-6 col-md-6 col-lg-6">
    <label>{{"START_DATE"|translate}}</label>
    <kendo-datepicker class="col-sm-12 col-md-12 col-lg-12" [ngModelOptions]="{standalone: true}"
                      (valueChange)="onSearch()"
                      [(ngModel)]='startDate' [format]="formatDate">
      <kendo-datepicker-messages today="{{'TODAY' | translate}}"
                                 toggle="Cambiar calendario"></kendo-datepicker-messages>
    </kendo-datepicker>
  </div>
  <div class="col-sm-6 col-md-6 col-lg-6">
    <label>{{"END_DATE"|translate}}</label>
    <kendo-datepicker class="col-sm-12 col-md-12 col-lg-12" [ngModelOptions]="{standalone: true}"
                      (valueChange)="onSearch()" [min]="startDate"
                      [(ngModel)]='endDate' [format]="formatDate">
      <kendo-datepicker-messages today="{{'TODAY' | translate}}"
                                 toggle="Cambiar calendario"></kendo-datepicker-messages>
    </kendo-datepicker>
  </div>
</div>
<div class="row mt-3">
  <div class="col-sm-6 col-md-6 col-lg-6">
    <label>{{"SEARCH_BY"|translate}}</label>
    <div class="col-sm-12 col-md-12 col-lg-12 input-group white">
      <kendo-combobox
        [data]="searchType" [(value)]="selectedSearchType"
        (valueChange)="onChangeSearchByType($event)"></kendo-combobox>
    </div>
  </div>
  <div class="col-sm-6 col-md-6 col-lg-6">
    <div class="col-sm-12 col-md-12 col-lg-12 input-group white mt-4">

      <kendo-combobox *ngIf="isSearchType" [data]="historySearchFields"
                      [valueField]="'key'" [textField]="'value'" [valuePrimitive]="true" [(value)]="selectedField"
                      (valueChange)="onChangeSearchField($event)">
      </kendo-combobox>
    </div>
  </div>
</div>
<div class="card-body">
  <form class="form-horizontal">
    <kendo-grid [data]="gridSettings.gridData"
                [pageSize]="gridSettings.state.take"
                [skip]="gridSettings.state.skip"
                [sortable]="true"
                (pageChange)="onPageChange($event)"
                (sortChange)="onSortChange($event)"
                [pageable]="pagerSettings"
                [reorderable]="true"
                [columnMenu]="true"
                [sort]="gridSettings.state.sort"
                [filter]="gridSettings.state.filter"
                (dataStateChange)="dataStateChange($event)">
      <kendo-grid-column [field]="gridSettings.columnsConfig[0].field"
                         [title]="gridSettings.columnsConfig[0].title | translate"
                         [width]="gridSettings.columnsConfig[0]._width"
                         [filter]="gridSettings.columnsConfig[0].filter"
                         [filterable]="gridSettings.columnsConfig[0].filterable"
                         [format]="gridSettings.columnsConfig[0].format">
        <ng-template kendoGridHeaderTemplate let-dataItem="dataItem">
          <span tooltip="{{gridSettings.columnsConfig[0].title |translate}}" theme="light">
            {{gridSettings.columnsConfig[0].title|translate}}</span>
        </ng-template>
        <ng-template kendoGridCellTemplate let-dataItem="dataItem">
          <span
            tooltip="{{dataItem.createdDate | date : formatDateTime}}">{{dataItem.createdDate | date : formatDateTime}}</span>
        </ng-template>
      </kendo-grid-column>
      <kendo-grid-column [field]="gridSettings.columnsConfig[1].field"
                         [title]="gridSettings.columnsConfig[1].title | translate"
                         [width]="gridSettings.columnsConfig[1]._width"
                         [filter]="gridSettings.columnsConfig[1].filter"
                         [filterable]="gridSettings.columnsConfig[1].filterable"
                         [format]="gridSettings.columnsConfig[1].format">
        <ng-template kendoGridHeaderTemplate let-dataItem="dataItem">
          <span tooltip="{{gridSettings.columnsConfig[1].title |translate}}" theme="light">
            {{gridSettings.columnsConfig[1].title|translate}}</span>
        </ng-template>
        <ng-template kendoGridCellTemplate let-dataItem="dataItem">
          <span tooltip="{{dataItem.action | translate}}">{{dataItem.action | translate}}</span>
        </ng-template>
      </kendo-grid-column>
      <kendo-grid-column [field]="gridSettings.columnsConfig[2].field"
                         [title]="gridSettings.columnsConfig[2].title | translate"
                         [width]="gridSettings.columnsConfig[2]._width"
                         [filter]="gridSettings.columnsConfig[2].filter"
                         [filterable]="gridSettings.columnsConfig[2].filterable"
                         [format]="gridSettings.columnsConfig[2].format">
        <ng-template kendoGridHeaderTemplate let-dataItem="dataItem">
          <span tooltip="{{gridSettings.columnsConfig[2].title |translate}}" theme="light">
            {{gridSettings.columnsConfig[2].title|translate}}</span>
        </ng-template>
        <ng-template kendoGridCellTemplate let-dataItem="dataItem">
          <span tooltip="{{dataItem.entityField | translate}}">{{dataItem.entityField }}</span>
        </ng-template>
      </kendo-grid-column>
      <kendo-grid-column [field]="gridSettings.columnsConfig[3].field"
                         [title]="gridSettings.columnsConfig[3].title | translate"
                         [width]="gridSettings.columnsConfig[3]._width"
                         [filter]="gridSettings.columnsConfig[3].filter"
                         [filterable]="gridSettings.columnsConfig[3].filterable"
                         [sortable]="false"
                         [format]="gridSettings.columnsConfig[3].format">
        <ng-template kendoGridHeaderTemplate let-dataItem="dataItem">
          <span tooltip="{{gridSettings.columnsConfig[3].title |translate}}" theme="light">
            {{gridSettings.columnsConfig[3].title|translate}}</span>
        </ng-template>
        <ng-template kendoGridCellTemplate let-dataItem="dataItem">
          <span style="white-space: pre-line" tooltip="{{dataItem.fieldOldValue | translate}}"
                *ngIf="dataItem.fieldOldValue !== null">{{dataItem.fieldOldValue | translate}}</span>
        </ng-template>
      </kendo-grid-column>
      <kendo-grid-column [field]="gridSettings.columnsConfig[4].field"
                         [title]="gridSettings.columnsConfig[4].title | translate"
                         [width]="gridSettings.columnsConfig[4]._width"
                         [filter]="gridSettings.columnsConfig[4].filter"
                         [filterable]="gridSettings.columnsConfig[4].filterable"
                         [sortable]="false"
                         [format]="gridSettings.columnsConfig[4].format">
        <ng-template kendoGridHeaderTemplate let-dataItem="dataItem">
          <span tooltip="{{gridSettings.columnsConfig[4].title |translate}}" theme="light">
            {{gridSettings.columnsConfig[4].title|translate}}</span>
        </ng-template>
        <ng-template kendoGridCellTemplate let-dataItem="dataItem">
          <span style="white-space: pre-line" tooltip="{{dataItem.fieldNewValue | translate}}"
                *ngIf="dataItem.fieldNewValue !== null">{{dataItem.fieldNewValue | translate}}</span>
        </ng-template>
      </kendo-grid-column>
      <kendo-grid-column [field]="gridSettings.columnsConfig[5].field"
                         [title]="gridSettings.columnsConfig[5].title | translate"
                         [width]="gridSettings.columnsConfig[5]._width"
                         [filter]="gridSettings.columnsConfig[5].filter"
                         [filterable]="gridSettings.columnsConfig[5].filterable"
                         [format]="gridSettings.columnsConfig[5].format">
        <ng-template kendoGridHeaderTemplate let-dataItem="dataItem">
          <span tooltip="{{gridSettings.columnsConfig[5].title |translate}}" theme="light">
            {{gridSettings.columnsConfig[5].title|translate}}</span>
        </ng-template>
        <ng-template kendoGridCellTemplate let-dataItem="dataItem">
          <span tooltip="{{dataItem.createdByFullName}}" theme="light">{{dataItem.createdByFullName}}</span>
        </ng-template>
      </kendo-grid-column>
    </kendo-grid>
  </form>
</div>

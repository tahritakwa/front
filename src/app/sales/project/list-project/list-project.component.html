<div class="card full-screen-card">
  <div class="card-content">
    <div class="card-header">
      <div class="col-sm-5 mt-1">
        <h3 class="card-title mb-0">{{'LIST_OF_SERVICE_CONTRACTS'|translate}}</h3>
      </div>
    </div>

    <div class="card-body">
      <app-advanced-search [filtreFieldsColumns]="filtreFieldsColumns"
      (filtrePredicateToSend)="getFiltrePredicate($event)" (predicateOperator)="getOperatorPredicate($event)"
      (searchClickEvent)="initGridDataSource(false)"  (resetClickEvent)="resetClickEvent()">
    </app-advanced-search>

      <kendo-grid [data]="gridSettings.gridData" [pageSize]="gridSettings.state.take" [skip]="gridSettings.state.skip"
        [sortable]="true" [pageable]="pagerSettings" [reorderable]="true" (remove)="removeHandler($event)"
        (dataStateChange)="dataStateChange($event)" [sort]="gridSettings.state.sort" [filter]="gridSettings.state.filter" [navigable]="true" [selectable]="true">
        <!-- Head Start-->
        <ng-template kendoGridToolbarTemplate>
            <app-btn-grid class="col" [advencedAdd]='haveAddPermission' [add]='false' [isExportExcel]='true'
            [addLink]='"add"' [relativeStyle]='true' [model]="true"
            [api]="'getDataWithSpecificFilter'" [service]="projectService" [fileName]="'LIST_OF_SERVICE_CONTRACTS'|translate"
            [gridSettings]="gridSettings" [predicate]="predicate">
          </app-btn-grid>
          </ng-template>
        <!-- Head end-->
        <!--Name-->
        <kendo-grid-column [field]="gridSettings.columnsConfig[0].field"
          [title]="gridSettings.columnsConfig[0].title | translate" [width]="gridSettings.columnsConfig[0]._width"
          [filter]="gridSettings.columnsConfig[0].filter" [filterable]="gridSettings.columnsConfig[0].filterable"
          [format]="gridSettings.columnsConfig[0].format">
        </kendo-grid-column>
        <!--ProjectType-->
        <kendo-grid-column [field]="gridSettings.columnsConfig[1].field"
          [title]="gridSettings.columnsConfig[1].title | translate" [width]="gridSettings.columnsConfig[1]._width"
          [filter]="gridSettings.columnsConfig[1].filter" [filterable]="gridSettings.columnsConfig[1].filterable"
          [format]="gridSettings.columnsConfig[1].format">
          <ng-template kendoGridCellTemplate let-dataItem>
            <div *ngIf="dataItem.ProjectType == projectTypeEnum.Regie; then thenRegieBlock else elseForfaitBlock"></div>
            <ng-template #thenRegieBlock>
              <span>{{'REGIE'|translate}}</span>
            </ng-template>
            <ng-template #elseForfaitBlock>
              <span>{{'FORFAIT'|translate}}</span>
            </ng-template>
          </ng-template>
        </kendo-grid-column>
        <!--Name-->
        <kendo-grid-column [field]="gridSettings.columnsConfig[2].field"
          [title]="gridSettings.columnsConfig[2].title | translate" [width]="gridSettings.columnsConfig[2]._width"
          [filter]="gridSettings.columnsConfig[2].filter" [filterable]="gridSettings.columnsConfig[2].filterable">
          <ng-template kendoGridCellTemplate let-dataItem="dataItem">
            <span *ngIf="dataItem.IdTiersNavigation"> {{dataItem.IdTiersNavigation.Name}}</span>
            <span *ngIf="!dataItem.IdTiersNavigation">-</span>
         </ng-template>
        </kendo-grid-column>
        <!--StartDate-->
        <kendo-grid-column [field]="gridSettings.columnsConfig[3].field"
          [title]="gridSettings.columnsConfig[3].title | translate" [width]="gridSettings.columnsConfig[3]._width"
          [filter]="gridSettings.columnsConfig[3].filter" [filterable]="gridSettings.columnsConfig[3].filterable"
          [format]="gridSettings.columnsConfig[3].format">
          <ng-template kendoGridCellTemplate let-dataItem="dataItem">
            {{dataItem.StartDate|date: formatDate}}
          </ng-template>
        </kendo-grid-column>
        <!--ExpectedEndDate-->
        <kendo-grid-column [field]="gridSettings.columnsConfig[4].field"
          [title]="gridSettings.columnsConfig[4].title | translate" [width]="gridSettings.columnsConfig[4]._width"
          [filter]="gridSettings.columnsConfig[4].filter" [filterable]="gridSettings.columnsConfig[4].filterable"
          [format]="gridSettings.columnsConfig[4].format">
          <ng-template kendoGridCellTemplate let-dataItem="dataItem">
            {{dataItem.ExpectedEndDate|date: formatDate}}
          </ng-template>
        </kendo-grid-column>
        <!--IsBillable-->
        <kendo-grid-column [field]="gridSettings.columnsConfig[5].field"
          [title]="gridSettings.columnsConfig[5].title | translate" [width]="gridSettings.columnsConfig[5]._width"
          [filter]="gridSettings.columnsConfig[5].filter" [filterable]="gridSettings.columnsConfig[5].filterable"
          [format]="gridSettings.columnsConfig[5].format">
          <ng-template kendoGridCellTemplate let-dataItem>
            <div style="padding-right: 20%;" *ngIf="dataItem.IsBillable == 1">
              <span class="badge badge-success">
                <i class="fa fa-check"></i>
              </span>
            </div>
            <div style="padding-right: 20%;" *ngIf="dataItem.IsBillable == 0">
              <span class="badge badge-danger" style="text-align:center">
                <i class="fa fa-close" style="width: 13px;height:11px;"></i>
              </span>
            </div>
          </ng-template>
        </kendo-grid-column>
        <!-- Command-->
        <kendo-grid-command-column [width]="130">
          <ng-template kendoGridCellTemplate let-isNew="isNew" let-dataItem="dataItem">
            <!--Open advanced edit form -->
              <i class="las la-pen cursor-pointer edit-pencil la-lg mx-3" aria-hidden="true"
                   (click)="goToAdvancedEdit(dataItem.Id)" *ngIf="haveUpdatePermission || haveShowPermission"></i>
            <!-- save command directive, will be visible when in edit mode -->
            <button kendoGridSaveCommand class="btnKendoGrid"><span class="fa fa-save"></span></button>
            <!-- cancel command directive, will be visible when in edit mode -->
            <button kendoGridCancelCommand class="btnKendoGrid"><span class="fa fa-close"></span></button>
            <!-- remove command directive, will be visible when not in edit mode -->
              <i class="fa fa-trash-o la-lg text-danger cursor-pointer" aria-hidden="true"
              (click)="removeHandler(dataItem)" *ngIf="haveDeletePermission"></i>
          </ng-template>
        </kendo-grid-command-column>
        <!--grid pdf & excel-->
        <app-grid-export [gridSettings]="gridSettings" fileName="{{'PROJECT_LIST'|translate}}" pdf="true" excel="true"
          [service]="projectService" [predicate]="predicate">
        </app-grid-export>
        <!--end grid pdf & excel-->
      </kendo-grid>
    </div>
  </div>
</div>

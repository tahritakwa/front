<div class="card full-screen-card">
  <div class="card-header" *ngIf="!isModal">
    <div class="col-sm-5 mt-1">
      <h3 class="card-title mb-0">{{'LIST_BILLING_SESSION'|translate}}</h3>
    </div>
  </div>
  <div class="card-body">
    <app-advanced-search [filtreFieldsColumns]="filtreFieldsColumns" [filtreFieldsInputs]="filtreFieldsInputs"
      (filtrePredicateToSend)="getFiltrePredicate($event)" (predicateOperator)="getOperatorPredicate($event)"
      (searchClickEvent)="initGridDataSource(false)" (resetClickEvent)="resetClickEvent()">
    </app-advanced-search>
    <div class="row d-flex justify-content-between mt-3">
      <app-search-session class="col-lg-3" (sendData)="receiveData($event)"></app-search-session>
      <app-btn-grid class="col" [advencedAdd]='hasAddPermission' [add]='false' [addLink]='"add"' [relativeStyle]='true' [model]="true"
        [api]="'getDataWithSpecificFilter'" [fileName]="'LIST_BILLING_SESSION'|translate" [service]="billingSessionService"
        [isExportExcel]="true" [gridSettings]="gridSettings" [predicate]="predicate">
      </app-btn-grid>
    </div>
    <div class="col-lg-12 col-md-12 col-sm-12 px-0">
      <div class="mb-3" style="float: left;width: 100%">
        <div class="tab-pane active show" id="home1" role="tabpanel">
          <kendo-grid [data]="gridSettings.gridData" [pageSize]="gridSettings.state.take"
            [skip]="gridSettings.state.skip" [sortable]="true" [pageable]="pagerSettings"
            [reorderable]="true" [sort]="gridSettings.state.sort"
            [filter]="gridSettings.state.filter" (dataStateChange)="dataStateChange($event)" [selectable]="true">
            <!--Session Code-->
            <kendo-grid-column [field]="gridSettings.columnsConfig[0].field"
              [title]="gridSettings.columnsConfig[0].title | translate" [width]="gridSettings.columnsConfig[0]._width"
              [filter]="gridSettings.columnsConfig[0].filter" [filterable]="gridSettings.columnsConfig[0].filterable"
              [format]="gridSettings.columnsConfig[0].format">
              <ng-template kendoGridHeaderTemplate>
                <span tooltip="{{gridSettings.columnsConfig[0].title|translate}}"
                  theme="light">{{gridSettings.columnsConfig[0].title|translate}}</span>
              </ng-template>
            </kendo-grid-column>
            <!-- Title -->
            <kendo-grid-column [field]="gridSettings.columnsConfig[1].field"
              [title]="gridSettings.columnsConfig[1].title | translate" [width]="gridSettings.columnsConfig[1]._width"
              [filter]="gridSettings.columnsConfig[1].filter" [filterable]="gridSettings.columnsConfig[1].filterable"
              [format]="gridSettings.columnsConfig[1].format">
              <ng-template kendoGridHeaderTemplate>
                <span tooltip="{{gridSettings.columnsConfig[1].title|translate}}"
                  theme="light">{{gridSettings.columnsConfig[1].title|translate}}</span>
              </ng-template>
            </kendo-grid-column>
            <!--Month-->
            <kendo-grid-column [field]=gridSettings.columnsConfig[2].field
              [title]="gridSettings.columnsConfig[2].title | translate" [width]="gridSettings.columnsConfig[2]._width"
              [filter]="gridSettings.columnsConfig[2].filter" [filterable]="gridSettings.columnsConfig[2].filterable"
              [format]="gridSettings.columnsConfig[2].format">
              <ng-template kendoGridHeaderTemplate>
                <span tooltip="{{gridSettings.columnsConfig[2].title|translate}}"
                  theme="light">{{gridSettings.columnsConfig[2].title|translate}}</span>
              </ng-template>
              <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                {{dataItem.Month | date:'MMMM' | uppercase | translate }} {{dataItem.Month | date: 'yyyy'}}
              </ng-template>
            </kendo-grid-column>
            <!--State-->
            <kendo-grid-column [field]="gridSettings.columnsConfig[3].field"
              [title]="gridSettings.columnsConfig[3].title| translate" [width]="gridSettings.columnsConfig[3]._width"
              [filter]="gridSettings.columnsConfig[3].filter" [filterable]="gridSettings.columnsConfig[3].filterable"
              [format]="gridSettings.columnsConfig[3].format">
              <ng-template kendoGridHeaderTemplate>
                <span tooltip="{{gridSettings.columnsConfig[3].title|translate}}"
                  theme="light">{{gridSettings.columnsConfig[3].title|translate}}</span>
              </ng-template>
              <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                <div class="badge badge-warning status-badge" *ngIf="dataItem.State === statusCode.New">
                  <span>{{'NEW'|translate}}</span>
                </div>
                <div class="badge badge-warning status-badge" *ngIf="dataItem.State === statusCode.Project">
                  <span>{{'PROJECT'|translate}}</span>
                </div>
                <div class="badge badge-success status-badge" *ngIf="dataItem.State === statusCode.Bills">
                  <span>{{'BILLS'|translate}}</span>
                </div>
                <div class="badge badge-danger status-badge" *ngIf="dataItem.State === statusCode.Closed">
                  <span>{{'CLOSED'|translate}}</span>
                </div>
              </ng-template>
            </kendo-grid-column>
            <kendo-grid-command-column [width]="130">
              <ng-template kendoGridCellTemplate let-dataItem="dataItem" let-isNew="isNew">
                <i *ngIf="hasUpdatePermission || hasShowPermission" class="las la-pen edit-pencil cursor-pointer la-lg" (click)="getBillingSession(dataItem.Id)"
                  tooltip="{{'UPDATE' | translate}}"></i>
                <i *ngIf="hasDeletePermission && dataItem.State !== statusCode.Closed" class="las la-trash-alt text-danger cursor-pointer la-lg"
                  (click)="removeHandler(dataItem)" tooltip="{{'DELETE' | translate}}"></i>
              </ng-template>
            </kendo-grid-command-column>
    
            <!--grid pdf & excel-->
            <app-grid-export [gridSettings]="gridSettings" fileName="{{'LIST_BILLING_SESSION'|translate}}" pdf="true"
              excel="true" [service]="billingSessionService" [predicate]="predicate">
            </app-grid-export>
            <!--end grid pdf & excel-->
          </kendo-grid>
        </div>
      </div>
    </div>
  </div>
</div>

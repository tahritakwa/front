<div class="col-lg-12 col-md-12 col-sm-12">
  <div class="row">
    <div class="card full-screen-card border-0 ">
      <div class="card-content">
        <!--Begin card header-->
        <div class="card-header">
          <div class="col-sm-5 mt-1">
            <h3 class="card-title mb-0">{{'CUSTOMER_LIST'|translate}}</h3>
          </div>
        </div>
        <!--End card header-->
        <!--Begin card body-->
        <div class="card-body">
          <app-advanced-search [filtreFieldsColumns]="filtreFieldsColumns" [filtreFieldsInputs]="filtreFieldsInputs"
            (filtrePredicateToSend)="getFiltrePredicate($event)" (predicateOperator)="getOperatorPredicate($event)"
            (searchClickEvent)="initGridDataSource(false)" (resetClickEvent)="resetClickEvent()">
          </app-advanced-search>
          <div class="row d-flex justify-content-between mt-3">
            <app-search-tiers class="col-lg-3" [type]="tiersType" (sendData)="receiveData($event)"></app-search-tiers>
            <app-btn-grid class="col" [advencedAdd]='hasAddPermission' [addLink]='"AdvancedAdd"' [cardView]='!isCardView'
              [listView]='isCardView' (cardViewEvent)="changeViewToCard()" (listViewEvent)="changeViewToList()"
              [relativeStyle]='true' (incomingFileEvent)="incomingFile($event)" [model]="true"
              (downLoadFileEvent)="downLoadFile($event)" [gridSettings]="exportGridSettings"
              [fileName]="'CUSTOMER_LIST'|translate" [service]="tiersService" [predicate]="predicateTiers"
              api="getDataWithSpecificFilter" [isExportExcel]="true" [isImportFile]="hasAddPermission" [isExportModel]="hasAddPermission">
            </app-btn-grid>
          </div>
          <div>
            <div class="" style="float: left;width: 100%">
              <div class="tab-pane active show" id="home1" role="tabpanel">
                <div *ngIf="!isCardView">
                  <kendo-grid [data]="gridSettings.gridData" [pageSize]="gridSettings.state.take"
                    [skip]="gridSettings.state.skip" [sort]="gridSettings.state.sort"
                    [filter]="gridSettings.state.filter" (edit)="editHandler($event)" (cancel)="cancelHandler($event)"
                    (save)="saveHandler($event)" (remove)="removeHandler($event)" (add)="addHandler($event)"
                    (dataStateChange)="dataStateChange($event)" [sortable]="true" [pageable]="pagerSettings"
                    [filterable]="false" [reorderable]="true" [columnMenu]="true" >
                    <!-- customer -->
                    <kendo-grid-column [title]="gridSettings.columnsConfig[1].title | translate"
                      [width]="gridSettings.columnsConfig[1]._width" [filter]="gridSettings.columnsConfig[1].filter"
                      [filterable]="gridSettings.columnsConfig[1].filterable"
                      [format]="gridSettings.columnsConfig[1].format" [tooltip]="gridSettings.columnsConfig[1].title"
                      [field]="gridSettings.columnsConfig[1].field" [columnMenu]="false">
                      <ng-template kendoGridHeaderTemplate>
                        <span tooltip="{{gridSettings.columnsConfig[1].title | translate}}"
                          theme="light">{{gridSettings.columnsConfig[1].title | translate}}</span>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem>

                        <div class="row" [ngClass]="{'cursor-pointer':hasShowPermission || hasUpdatePermission}"
                          (click)="hasShowPermission || hasUpdatePermission ? goToProfile(dataItem) : ''">
                          <div class="col-auto">
                            <div class="customer-photo d-flex justify-content-center">
                              <img id="ThumbnailCostumer" class="imgSize" alt="Illustration des problÃ¨mes de suddation"
                                border="0" [src]="dataItem.image" />
                            </div>
                          </div>
                          <div class="col">
                            <div class="row">
                              <span class="font-weight-bold">{{dataItem.Name}}</span>
                            </div>
                            <div class="row">
                              <span class="light-reference">{{dataItem.CodeTiers}}</span>
                            </div>
                          </div>
                        </div>

                      </ng-template>
                    </kendo-grid-column>
                    <!-- end customer -->
                    <!--Actions-->
                    <kendo-grid-command-column [width]="60" [columnMenu]="false">
                      <ng-template kendoGridCellTemplate let-isNew="isNew" let-dataItem="dataItem">
                        <!--Open advanced edit form -->
                        <i *ngIf="hasShowPermission || hasUpdatePermission" class="las la-pen cursor-pointer edit-pencil la-lg" aria-hidden="true"
                          (click)="goToAdvancedEdit(dataItem)"></i>
                      </ng-template>
                    </kendo-grid-command-column>
                    <!--End Actions-->

                    <!-- Email -->
                    <kendo-grid-column [title]="gridSettings.columnsConfig[2].title | translate"
                      [width]="gridSettings.columnsConfig[2]._width" [filter]="gridSettings.columnsConfig[2].filter"
                      [filterable]="gridSettings.columnsConfig[2].filterable"
                      [format]="gridSettings.columnsConfig[2].format" [field]="gridSettings.columnsConfig[2].field"
                      [columnMenu]="false">
                      <ng-template kendoGridHeaderTemplate>
                        <span tooltip="{{gridSettings.columnsConfig[2].title | translate}}"
                          theme="light">{{gridSettings.columnsConfig[2].title | translate}}</span>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem>
                        <span *ngIf="dataItem.Email"> {{dataItem.Email}}</span>
                        <span *ngIf="!dataItem.Email">-</span>
                      </ng-template>
                    </kendo-grid-column>

                    <!-- phone -->
                    <kendo-grid-column [title]="gridSettings.columnsConfig[7].title | translate"
                      [width]="gridSettings.columnsConfig[7]._width" [filter]="gridSettings.columnsConfig[7].filter"
                      [filterable]="gridSettings.columnsConfig[7].filterable"
                      [format]="gridSettings.columnsConfig[7].format" [field]="gridSettings.columnsConfig[7].field"
                      [columnMenu]="false">
                      <ng-template kendoGridHeaderTemplate>
                        <span tooltip="{{gridSettings.columnsConfig[7].title | translate}}"
                          theme="light">{{gridSettings.columnsConfig[7].title | translate}}</span>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                        <span *ngIf="dataItem.IdPhoneNavigation?.Number">
                          {{dataItem.IdPhoneNavigation.DialCode}}
                          {{dataItem.IdPhoneNavigation.Number}}
                        </span>
                        <span *ngIf="!dataItem.IdPhoneNavigation">-</span>
                      </ng-template>
                    </kendo-grid-column>
                    
                    <!-- Country -->
                    <kendo-grid-column [title]="gridSettings.columnsConfig[4].title | translate"
                      [width]="gridSettings.columnsConfig[4]._width" [filter]="gridSettings.columnsConfig[4].filter"
                      [filterable]="gridSettings.columnsConfig[4].filterable"
                      [format]="gridSettings.columnsConfig[4].format" [field]="gridSettings.columnsConfig[4].field"
                      [columnMenu]="false">
                      <ng-template kendoGridHeaderTemplate>
                        <span tooltip="{{gridSettings.columnsConfig[4].title | translate}}"
                          theme="light">{{gridSettings.columnsConfig[4].title | translate}}</span>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem>
                        {{dataItem.Address && dataItem.Address.length && dataItem.Address[0].IdCountryNavigation ?
                        dataItem.Address[0].IdCountryNavigation.NameFr : '-'}}
                      </ng-template>
                    </kendo-grid-column>
                    <!-- City -->
                    <kendo-grid-column [title]="gridSettings.columnsConfig[3].title | translate"
                      [width]="gridSettings.columnsConfig[3]._width" [filter]="gridSettings.columnsConfig[3].filter"
                      [filterable]="gridSettings.columnsConfig[3].filterable"
                      [format]="gridSettings.columnsConfig[3].format" [field]="gridSettings.columnsConfig[3].field"
                      [columnMenu]="false">
                      <ng-template kendoGridHeaderTemplate>
                        <span tooltip="{{gridSettings.columnsConfig[3].title | translate}}"
                          theme="light">{{gridSettings.columnsConfig[3].title | translate}}</span>
                      </ng-template>
                      <ng-template kendoGridCellTemplate let-dataItem>
                        {{dataItem.Address && dataItem.Address.length && dataItem.Address[0].IdCityNavigation ?
                        dataItem.Address[0].IdCityNavigation.Label : '-'}}
                      </ng-template>
                    </kendo-grid-column>

                     <!-- Category -->
                     <kendo-grid-column [title]="gridSettings.columnsConfig[9].title | translate"
                     [width]="gridSettings.columnsConfig[9]._width" [filter]="gridSettings.columnsConfig[9].filter"
                     [filterable]="gridSettings.columnsConfig[9].filterable"
                     [format]="gridSettings.columnsConfig[9].format" [field]="gridSettings.columnsConfig[9].field"
                     [columnMenu]="false">
                     <ng-template kendoGridHeaderTemplate>
                       <span tooltip="{{gridSettings.columnsConfig[9].title | translate}}"
                         theme="light">{{gridSettings.columnsConfig[9].title | translate}}</span>
                     </ng-template>
                     <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                      <span *ngIf="dataItem.IdTierCategoryNavigation?.Name">
                        {{dataItem.IdTierCategoryNavigation.Name}}
                      </span>
                      <span *ngIf="!dataItem.IdTierCategoryNavigation">-</span>
                    </ng-template>
                   </kendo-grid-column>


                    <!-- Devise -->
                    <kendo-grid-column [title]="gridSettings.columnsConfig[5].title | translate"
                      [width]="gridSettings.columnsConfig[5]._width" [filter]="gridSettings.columnsConfig[5].filter"
                      [filterable]="gridSettings.columnsConfig[5].filterable"
                      [format]="gridSettings.columnsConfig[5].format" [field]="gridSettings.columnsConfig[5].field"
                      [columnMenu]="false">
                      <ng-template kendoGridHeaderTemplate>
                        <span tooltip="{{gridSettings.columnsConfig[5].title | translate}}"
                          theme="light">{{gridSettings.columnsConfig[5].title | translate}}</span>
                      </ng-template>
                    </kendo-grid-column>

                    <!-- Tax Group -->
                    <kendo-grid-column [title]="gridSettings.columnsConfig[6].title | translate"
                      [width]="gridSettings.columnsConfig[6]._width" [filter]="gridSettings.columnsConfig[6].filter"
                      [filterable]="gridSettings.columnsConfig[6].filterable"
                      [format]="gridSettings.columnsConfig[6].format" [field]="gridSettings.columnsConfig[6].field"
                      [columnMenu]="false">
                      <ng-template kendoGridHeaderTemplate>
                        <span tooltip="{{gridSettings.columnsConfig[6].title | translate}}"
                          theme="light">{{gridSettings.columnsConfig[6].title | translate}}</span>
                      </ng-template>
                    </kendo-grid-column>

                    <!-- column select -->
                    <kendo-grid-command-column [width]="50" [columnMenu]="true">
                    </kendo-grid-command-column>
                    <!--End Columns-->
                    </kendo-grid>
                </div>
                <div class="mb-3" *ngIf="isCardView">
                  <app-card-customer [cardstate]="gridSettings.state" [data]="gridSettings.gridData.data"
                    [isCardView]="isCardView" [totalCards]="totalCards" [totalCustomers]="totalCustomers"
                    [gridSettings]="gridSettings" (DoPaginte)="paginate($event)">
                  </app-card-customer>
                </div>
              </div>
            </div>
          </div>
        </div>
        <!--End card body-->
      </div>
    </div>
  </div>
</div>

<div class="overlay"
  [ngClass]="{'grid-importer-show':dataImported, 'grid-importer-hide': !dataImported}">
  <a class="closebtn" (click)="onClosePopupImport()">&times;</a>
  <div class="overlay-content" *ngIf="dataImported">
    <app-grid-import [importResult]="importData" [saveImportedData]="saveImportedData.bind(this)"
      [formGroup]="importFormGroup" [importColumnsConfig]="importColumnsConfig"></app-grid-import>
  </div>
</div>

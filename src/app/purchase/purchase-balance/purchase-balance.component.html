<div class="card full-screen-card">
  <!--Begin Card header-->
  <div class="card-header">
    <div class="col-sm-5 mt-1">
      <h3 class="card-title mb-0">{{ 'PURCHASE_BALANCE' |translate }}</h3>
    </div>
  </div>
  <!--End Card header-->
    <!--Begin Card body-->
    <div class="card-body">
      <app-advanced-search [filtreFieldsColumns]="filtreFieldsColumns" [filtreFieldsInputs]="filtreFieldsInputs"
                           (filtrePredicateToSend)="getFiltrePredicate($event)"
                           (searchClickEvent)="searchBalance(false)" (resetClickEvent)="resetClickEvent()" [fromBalancePurchase] ="true">
      </app-advanced-search>

      <div class="row d-flex justify-content-between mt-3" *ngIf="gridData.length">
        <div class="col-lg-4 col-md-4 col-sm-4">
          <div class="d-flex justify-content-center">
            <div class="col-12 mt-2">
              <div class="form-group row">
                <div class="col-10">
                  <input type="text" class="form-control" placeholder="{{'PURCHASE_BALANCE_SEARCH'|translate}}"
                         aria-describedby="addon-wrapping" [(ngModel)]='purchaseBalanceSearchedValue' (keyup)='filtere()'
                         [ngModelOptions]="{standalone: true}">
                </div>
                <div class="col-2 p-1">
                  <i class="fa fa-search fa-lg" aria-hidden="true" (click)='filtere()'></i>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>

     <!-- <div class="form-group row">
        &lt;!&ndash;Item&ndash;&gt;
        <div class="col-lg-8 col-md-10 col-sm-12 row">
          <label class="col-lg-2 col-md-6 col-sm-12">{{'SUPPLIER'|translate}}<span class="required">*</span></label>
          <div class="col-lg-6 col-md-6 col-sm-12">
            <app-supplier-dropdown [type]=2 [itemForm]="purchaseBalanceFormGroup"
                                   class="error-msg messages text-left text-danger" hideAddBtn="true">
            </app-supplier-dropdown>
            <app-control-messages [control]="purchaseBalanceFormGroup.controls.IdTiers"
                                  class="error-msg messages text-left text-danger"></app-control-messages>
          </div>
          <div class="col-lg-4 col-md-6 col-sm-12">
            <button class="k-button btn-secondary ml-3 mr-2" type="button" (click)="searchBalance()">
              <i class="fa fa-search fa-lg"></i>
              <span>&nbsp; &nbsp;{{'SEARCH' | translate}}</span>
            </button>
          </div>
        </div>

      </div>-->
          <kendo-grid [data]="gridSettings.gridData" [pageSize]="gridSettings.state.take" [skip]="gridSettings.state.skip" [sortable]="true"
                      [pageable]="pagerSettings"
                      [filterable]="false" [reorderable]="true"
                      (dataStateChange)="dataStateChange($event)"
                      [sort]="gridSettings.state.sort" [filter]="gridSettings.state.filter" [navigable]="true"
                      (cellClick)="lineClickHandler($event)"
                      (remove)="removeLine($event)" #grid>

            <kendo-grid-column [field]="gridSettings.columnsConfig[0].field" [title]="gridSettings.columnsConfig[0].title | translate"
                               [width]="gridSettings.columnsConfig[0].width" [filter]="gridSettings.columnsConfig[0].filter"
                               [filterable]="gridSettings.columnsConfig[0].filterable" [format]="gridSettings.columnsConfig[0].format">
              <ng-template kendoGridHeaderTemplate let-column let-columnIndex="columnIndex">
                     <span tooltip="{{column.title | translate}}" theme="light">
                         {{column.title}}
                     </span>
              </ng-template>
            </kendo-grid-column>

            <kendo-grid-column [field]="gridSettings.columnsConfig[1].field" [title]="gridSettings.columnsConfig[1].title | translate"
                               [width]="gridSettings.columnsConfig[1].width" [filter]="gridSettings.columnsConfig[1].filter"
                               [filterable]="gridSettings.columnsConfig[1].filterable" [format]="gridSettings.columnsConfig[1].format">
              <ng-template kendoGridHeaderTemplate let-column let-columnIndex="columnIndex">
                     <span tooltip="{{column.title | translate}}" theme="light">
                         {{column.title}}
                     </span>
              </ng-template>
            </kendo-grid-column>

            <kendo-grid-column [field]="gridSettings.columnsConfig[2].field" [title]="gridSettings.columnsConfig[2].title | translate"
                               [width]="gridSettings.columnsConfig[2].width" [filter]="gridSettings.columnsConfig[2].filter"
                               [filterable]="gridSettings.columnsConfig[2].filterable" [format]="gridSettings.columnsConfig[2].format"
                               [style]='{"text-align": "right", "padding-right": "3%"}'>
              <ng-template kendoGridHeaderTemplate let-column let-columnIndex="columnIndex">
                     <span tooltip="{{column.title | translate}}" theme="light">
                         {{column.title}}
                     </span>
              </ng-template>
            </kendo-grid-column>

            <kendo-grid-column [field]="gridSettings.columnsConfig[3].field" [title]="gridSettings.columnsConfig[3].title | translate"
                               [width]="gridSettings.columnsConfig[3].width" [filter]="gridSettings.columnsConfig[3].filter"
                               [filterable]="gridSettings.columnsConfig[3].filterable" [format]="gridSettings.columnsConfig[3].format"
                               [style]='{"text-align": "right", "padding-right": "3%"}'>
              <ng-template kendoGridHeaderTemplate let-column let-columnIndex="columnIndex">
                     <span tooltip="{{column.title | translate}}" theme="light">
                         {{column.title}}
                     </span>
              </ng-template>
            </kendo-grid-column>

            <kendo-grid-column [field]="gridSettings.columnsConfig[4].field" [title]="gridSettings.columnsConfig[4].title | translate"
                               [width]="gridSettings.columnsConfig[4].width" [filter]="gridSettings.columnsConfig[4].filter"
                               [filterable]="gridSettings.columnsConfig[4].filterable" [format]="gridSettings.columnsConfig[4].format"
                               [style]='{"text-align": "right"}'>
              <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                <kendo-numerictextbox
                  [spinners]="false" [format]="dataItem.FormatOption" [step]="1" style="border: none !important;"
                  class="form-control inputEnabled as-label numeric-style"
                  [value]="dataItem.PUPurchase" [disabled]="true">
                </kendo-numerictextbox>
              </ng-template>

            </kendo-grid-column>

            <kendo-grid-column [field]="gridSettings.columnsConfig[5].field" [title]="gridSettings.columnsConfig[5].title | translate"
                               [width]="gridSettings.columnsConfig[5].width" [filter]="gridSettings.columnsConfig[5].filter"
                               [filterable]="gridSettings.columnsConfig[5].filterable" [format]="gridSettings.columnsConfig[5].format"
                               [style]='{"text-align": "right", "padding-right": "3%"}'>
              <ng-template kendoGridHeaderTemplate let-column let-columnIndex="columnIndex">
                    <span tooltip="{{column.title | translate}}" theme="light">
                        {{column.title}}
                    </span>
              </ng-template>
              <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                <kendo-numerictextbox
                  [spinners]="false" [format]="dataItem.FormatOption" [step]="1" style="border: none !important;"
                  class="form-control inputEnabled as-label numeric-style"
                  [value]="dataItem.TotalPuPurchase" [disabled]="true">
                </kendo-numerictextbox>
              </ng-template>
            </kendo-grid-column>

            <kendo-grid-column [field]="gridSettings.columnsConfig[6].field" [title]="gridSettings.columnsConfig[6].title | translate"
                               [width]="gridSettings.columnsConfig[6].width" [filter]="gridSettings.columnsConfig[6].filter"
                               [filterable]="gridSettings.columnsConfig[6].filterable" [format]="gridSettings.columnsConfig[6].format">
              <ng-template kendoGridHeaderTemplate let-column let-columnIndex="columnIndex">
                    <span tooltip="{{column.title | translate}}" theme="light">
                        {{column.title}}
                    </span>
              </ng-template>
              <ng-template kendoGridCellTemplate let-dataItem="dataItem">

                <span class="pointer doc-code" (click)="showDocument(dataItem)">{{dataItem.CodeOrderDocument}}</span>


              </ng-template>
            </kendo-grid-column>

            <kendo-grid-column [field]="gridSettings.columnsConfig[7].field" [title]="gridSettings.columnsConfig[7].title | translate"
                               [width]="gridSettings.columnsConfig[7].width" [filter]="gridSettings.columnsConfig[7].filter"
                               [filterable]="gridSettings.columnsConfig[7].filterable" [format]="gridSettings.columnsConfig[7].format"
                               [style]='{"text-align": "right", "padding-right": "3%"}'>
              <ng-template kendoGridHeaderTemplate let-column let-columnIndex="columnIndex">
                    <span tooltip="{{column.title | translate}}" theme="light">
                        {{column.title}}
                    </span>
                </ng-template>
                <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                    {{dataItem.DateOrderDocument|date: format}}
                </ng-template>
                <ng-template kendoGridFilterCellTemplate let-filter let-column="column">
                    <kendo-datepicker [(value)]="dateOrderDocumentValueFilter" (valueChange)="onChangeValueDateFilter()"
                     style="width: 150px;
                    font-size: 12px;border: 1px solid #dddde5 !important;
                    border-radius: 5px;">
                    <kendo-datepicker-messages today="{{ 'TODAY' | translate}}" toggle="Cambiar calendario">
                    </kendo-datepicker-messages>
                  </kendo-datepicker>
                </ng-template>

            </kendo-grid-column>

            <kendo-grid-column [field]="gridSettings.columnsConfig[8].field" [title]="gridSettings.columnsConfig[8].title | translate"
                               [width]="gridSettings.columnsConfig[8].width" [filter]="gridSettings.columnsConfig[8].filter"
                               [filterable]="gridSettings.columnsConfig[8].filterable" [format]="gridSettings.columnsConfig[8].format">
              <ng-template kendoGridHeaderTemplate let-column let-columnIndex="columnIndex">
                    <span tooltip="{{column.title | translate}}" theme="light">
                        {{column.title}}
                    </span>
              </ng-template>
              <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                <span *ngIf="dataItem.DateDispo"> {{dataItem.DateDispo|date: format}}</span>
                <span *ngIf="!dataItem.DateDispo">-</span>
             </ng-template>
                <ng-template kendoGridEditTemplate>
                    <div [formGroup]="formGroup">
                        <kendo-datepicker formControlName="DateDispo" [format]="format" class="form-control" [min]="minDate">
                        </kendo-datepicker>
                    </div>
                </ng-template>
                <ng-template kendoGridFilterCellTemplate let-filter let-column="column">
                    <kendo-datepicker [(value)]="DateDispoDocumentValueFilter" (valueChange)="onChangeValueDateFilter()">
                      <kendo-datepicker-messages today="{{ 'TODAY' | translate}}" toggle="Cambiar calendario">
                      </kendo-datepicker-messages>
                    </kendo-datepicker>

                </ng-template>
            </kendo-grid-column>

            <kendo-grid-command-column title="" [width]='100'>
              <ng-template kendoGridCellTemplate>
                <div style="display: flex; margin-top: 5%;">
                  <button kendoGridRemoveCommand class="noPadding btn-Add k-button" dir="ltr"
                          style="border: none; color: #E91E63 !important;" type="button" *ngIf='!isShowForm'>
                    <i class="fa fa-times fa-lg"></i>
                  </button>
                  <button class='noPadding btn-Add' *ngIf="isInEditingMode && !isShowForm" kendoGridSaveCommand
                          id='btnSave' type="button" (click)="saveCurrent()">
                    <i class="fa fa-check fa-lg AddIcon" aria-hidden="true"></i>
                  </button>

                  <button kendoGridCancelCommand *ngIf="isInEditingMode && !isShowForm"
                          class="noPadding btn-Add k-button" (click)="cancelHandler($event)" type="button">
                    <i class="fa fa-ban fa-lg" style="color: #E91E63;" aria-hidden="true"></i>
                  </button>
                </div>
              </ng-template>
            </kendo-grid-command-column>
          </kendo-grid>
        </div>
    <!--End add form-->
</div>

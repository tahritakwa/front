<div class="card">
  <div class="card-header">
    <div class="col-sm-5 mt-1">
      <h3 class="card-title mb-0">{{'LIST_CONTRACT'|translate}}</h3>
    </div>
  </div>
  <div class="card-body">
    <form class="form-horizontal">
      <app-advanced-search [filtreFieldsColumns]="filtreFieldsColumns" [filtreFieldsInputs]="filtreFieldsInputs"
        (filtrePredicateToSend)="getFiltrePredicate($event)" (predicateOperator)="getOperatorPredicate($event)"
        (searchClickEvent)="initGridDataSource()" (resetClickEvent)="resetClickEvent()">
      </app-advanced-search>
      <div class="row d-flex justify-content-between mt-3">
        <app-btn-grid class="col" [advencedAdd]='hasAddPermission' [addLink]='"add"'
          [relativeStyle]='true' [model]="true" [gridSettings]="gridSettings"
          [fileName]="'CONTRACT_LIST'|translate" [service]="contractService" [predicate]="predicate"
          api="getDataSourcePredicate" [isExportExcel]="true">
        </app-btn-grid>
      </div>
      <kendo-grid [data]="gridSettings.gridData" [pageSize]="gridSettings.state.take" [skip]="gridSettings.state.skip"
        [selectable]="true" [sortable]="true" [pageable]="pagerSettings" [reorderable]="true" [sort]="gridSettings.state.sort"
        [filter]="gridSettings.state.filter" (dataStateChange)="dataStateChange($event)">
        <!--PrÃ©nom-->
        <kendo-grid-column [field]="gridSettings.columnsConfig[0].field"
          [title]="gridSettings.columnsConfig[0].title | translate" [width]="gridSettings.columnsConfig[0]._width"
          [filter]="gridSettings.columnsConfig[0].filter" [filterable]="gridSettings.columnsConfig[0].filterable"
          [format]="gridSettings.columnsConfig[0].format">
          <ng-template kendoGridCellTemplate let-dataItem>
            <span> {{dataItem.IdEmployeeNavigation.FirstName}} {{dataItem.IdEmployeeNavigation.LastName}} </span>
          </ng-template>
        </kendo-grid-column>
        <!-- Contract type -->
        <kendo-grid-column [field]="gridSettings.columnsConfig[1].field"
          [title]="gridSettings.columnsConfig[1].title | translate" [width]="gridSettings.columnsConfig[1]._width"
          [filter]="gridSettings.columnsConfig[1].filter" [filterable]="gridSettings.columnsConfig[1].filterable"
          [format]="gridSettings.columnsConfig[1].format">
        </kendo-grid-column>
        <!-- Salary structure -->
        <kendo-grid-column [field]="gridSettings.columnsConfig[2].field"
          [title]="gridSettings.columnsConfig[2].title | translate" [width]="gridSettings.columnsConfig[2]._width"
          [filter]="gridSettings.columnsConfig[2].filter" [filterable]="gridSettings.columnsConfig[2].filterable"
          [format]="gridSettings.columnsConfig[2].format">
        </kendo-grid-column>
        <!--Start Date-->
        <kendo-grid-column [field]="gridSettings.columnsConfig[3].field"
          [title]="gridSettings.columnsConfig[3].title | translate" [width]="gridSettings.columnsConfig[3]._width"
          [filter]="gridSettings.columnsConfig[3].filter" [filterable]="gridSettings.columnsConfig[3].filterable"
          [format]="gridSettings.columnsConfig[3].format">
          <ng-template kendoGridCellTemplate let-dataItem>
            {{dataItem.StartDate | date:formatDate}}
          </ng-template>
        </kendo-grid-column>

        <!--End date-->
        <kendo-grid-column [field]="gridSettings.columnsConfig[4].field"
          [title]="gridSettings.columnsConfig[4].title | translate" [width]="gridSettings.columnsConfig[4]._width"
          [filter]="gridSettings.columnsConfig[4].filter" [filterable]="gridSettings.columnsConfig[4].filterable"
          [format]="gridSettings.columnsConfig[4].format">
          <ng-template kendoGridCellTemplate let-dataItem>
            {{dataItem.EndDate | date:formatDate}}
          </ng-template>
        </kendo-grid-column>

        <!--State-->
        <kendo-grid-column [field]="gridSettings.columnsConfig[5].field"
          [title]="gridSettings.columnsConfig[5].title | translate" [width]="gridSettings.columnsConfig[5]._width"
          [filter]="gridSettings.columnsConfig[5].filter" [filterable]="gridSettings.columnsConfig[5].filterable"
          [format]="gridSettings.columnsConfig[5].format">
          <ng-template kendoGridCellTemplate let-dataItem="dataItem">
            <span style="margin-left: 5% !important;" *ngIf="dataItem.State == contractStateEnumerator.New"
              class="badge badge-primary">{{'NEW'|translate}}</span>
            <span style=" margin-left: 5% !important;" *ngIf="dataItem.State == contractStateEnumerator.InProgress"
              class="badge badge-success">{{'IN_PROGESS'|translate}}</span>
            <span style="margin-left: 5% !important;" *ngIf="dataItem.State == contractStateEnumerator.Done"
              class="badge badge-danger">{{'DONE'|translate}}</span>
            <span style="margin-left: 5% !important;" *ngIf="dataItem.State == contractStateEnumerator.UpComing"
              class="badge badge-warning">{{'UPCOMING'|translate}}</span>
          </ng-template>
        </kendo-grid-column>
        <!-- Command--> 
        <kendo-grid-command-column [width]="130">
          <ng-template kendoGridCellTemplate let-isNew="isNew" let-dataItem="dataItem">
            <!-- Update contract -->
            <i *ngIf="hasShowPermission || hasUpdatePermission" class="las la-pen edit-pencil cursor-pointer la-lg" (click)="goToAdvancedEdit(dataItem.Id)"
              tooltip="{{'UPDATE' | translate}}"></i>
            <!-- Remove Contract-->
            <i *ngIf="hasDeletePermission && dataItem.State !== contractStateEnumerator.Done" class="las la-trash-alt text-danger cursor-pointer la-lg"
              tooltip="{{'DELETE' | translate}}" (click)="removeHandler(dataItem)"></i>
          </ng-template>
        </kendo-grid-command-column>
        <!--grid pdf & excel-->
        <app-grid-export [gridSettings]="gridSettings" fileName="{{'LIST_CONTRACT'|translate}}" pdf="true" excel="true"
          [service]="contractService" [predicate]="predicate">
        </app-grid-export>
      </kendo-grid>
    </form>
  </div>
</div>

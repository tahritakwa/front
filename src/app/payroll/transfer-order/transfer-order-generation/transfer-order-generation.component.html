<div class="col-lg-12 col-md-12 col-sm-12">
  <div class="card border-0 full-screen-card">

    <!--Begin Card eader-->
    <div class="card-header" *ngIf="!isModal">
      <div class="row">
        <div class="col-sm-5 mt-1  d-flex justify-content-start">
          <h3 class="card-title mb-0">{{ (isUpdateMode ? 'EDIT_TRANSFER_ORDER': 'GENERATE_TRANSFER_ORDER') |translate }}
          </h3>
        </div>
        <div class="col-lg-2 ml-auto">
          <div class="row d-flex justify-content-end">
            <div class="col-lg-auto col-md-1 col-sm-12 primaryColor">
              <div class="row pl-3">
                <div class="col-auto d-flex align-items-end" style="width: 220px">
                  <input class="form-control InvoiceNumber pb-0"
                    [value]="transferOrderFormGroup.controls['Code']?.value">
                </div>
              </div>
            </div>
          </div>
        </div>
        <div class="col-lg-1 mt-2">
          <div class=" row col-lg-auto col-md-3 col-sm-12 d-flex align-items-end mt-1">
            <h4 class="statusAlignment" *ngIf="transferOrder &&transferOrder.State === transferOrderStatus.InProgress">
              <span class="badge badge-primary">{{"INPROGRESS" | translate }}</span>
            </h4>
            <h4 class="statusAlignment" *ngIf="transferOrder && transferOrder.State === transferOrderStatus.Correct">
              <span class="badge badge-success">{{"OPEN" | translate }}</span>
            </h4>
            <h4 class="statusAlignment" *ngIf=" transferOrder && transferOrder.State === transferOrderStatus.Wrong">
              <span class="badge badge-warning">{{ "WRONG" | translate }}</span>
            </h4>
            <h4 class="statusAlignment" *ngIf=" transferOrder && transferOrder.State === transferOrderStatus.Closed">
              <span class="badge badge-danger">{{ "CLOSED" | translate }}</span>
            </h4>
          </div>
        </div>
      </div>
    </div>
    <div class="card-body" [formGroup]="transferOrderFormGroup">
        <div class="col-lg-12 col-sm-12 col-md-12 mr-5">
          <!-- Label and bank accounbt form group row-->
          <div class="form-group row">
            <!-- Transfer order label section-->
            <div class="col-sm-12 col-md-6 col-lg-4">
              <label class="col-lg-12 col-md-12 col-sm-12"> {{'TITLE'|translate}}<span class="required">*</span></label>
              <input class="form-control" formControlName="Title" type="text"
                [ngClass]="{ 'has-error': (Title.touched || Title.dirty) && !Title.valid }">
              <app-control-messages [control]="Title" class="error-msg messages text-left text-danger">
              </app-control-messages>
            </div>
            <!-- Month -->
            <div class="col-sm-12 col-md-6 col-lg-4">
              <label class="col-lg-12 col-md-12 col-sm-12"> {{'MONTH'|translate}}<span class="required">*</span></label>
              <kendo-datepicker [bottomView]="'year'" [topView]="'decade'" [format]="'MMMM yyyy'"
                formControlName="Month" class="form-control">
                <kendo-datepicker-messages today="{{ 'TODAY' | translate}}" toggle="Cambiar calendario">
                </kendo-datepicker-messages>
              </kendo-datepicker>
              <app-control-messages [control]="Month" class="error-msg messages text-left text-danger">
              </app-control-messages>
            </div>
            <!-- Transfer order bank account section-->
            <div class="col-sm-12 col-md-6 col-lg-4">
              <label class="col-lg-12 col-md-12 col-sm-12"> {{'BANK_ACCOUNT'|translate}}<span
                  class="required">*</span></label>
              <app-bank-account-dropdown [bankAccountForm]="transferOrderFormGroup">
              </app-bank-account-dropdown>
              <app-control-messages [control]="IdBankAccount" class="error-msg messages text-left text-danger">
              </app-control-messages>
            </div>
          </div>
        </div>
        <div align="right" class="col-lg-12 col-md-12 col-sm-12 col-sx-12">
          <button class="generate ml-3 mr-2" type="submit" *ngIf="hasGeneratePermission
          && transferOrder.State === transferOrderStatus.InProgress" (click)="generate()" type="submit">
            <i class="fa fa-cogs fa-lg AddIcon"></i>
            {{'GENERATE' |translate}}
          </button>
          <button class="generate ml-3 mr-2" type="submit"
            *ngIf="hasRegeneratePermission 
          && transferOrder.State !== transferOrderStatus.InProgress && transferOrder.State !== transferOrderStatus.Closed" (click)="generate()" type="submit">
            <i class="fa fa-cogs fa-lg AddIcon"></i>
            {{'REGENERATE' |translate}}
          </button>
        </div>
        <!-- Transfer order employee selected grid -->
        <div class="col-lg-12 col-sm-12 col-md-12" style="margin-top:60px">
          <kendo-grid [data]="gridSettings.gridData" [pageSize]="gridSettings.state.take"
            [skip]="gridSettings.state.skip" [sortable]="true" [reorderable]="true"
            [selectable]="{enabled: true, checkboxOnly: true }"
            (selectedKeysChange)="onSelectedKeysChange($event)" [sort]="gridSettings.state.sort"
            [filter]="gridSettings.state.filter" (dataStateChange)="dataStateChange($event)" [kendoGridSelectBy]="'Id'"
            [selectedKeys]="employeesIdsSelected" [navigable]="true" [pageable]="pagerSettings">
            <kendo-grid-checkbox-column [width]="100" *ngIf="hasUpdatePermission && transferOrder.State !== transferOrderStatus.Closed">
              <ng-template kendoGridHeaderTemplate>
                <div class="checkbox-position">
                  <input class="k-checkbox" id="selectAllCheckboxId" *ngIf="!canUpdatePays" kendoGridSelectAllCheckbox
                    [state]="selectAllState" (selectAllChange)="onSelectAllChange($event)">
                  <label class="k-checkbox-label" for="selectAllCheckboxId"></label>
                </div>
              </ng-template>
            </kendo-grid-checkbox-column>
            <kendo-grid-column [field]="gridSettings.columnsConfig[0].field"
              [width]="gridSettings.columnsConfig[0]._width" [title]="gridSettings.columnsConfig[0].title|translate"
              [filterable]="gridSettings.columnsConfig[0].filterable">
            </kendo-grid-column>
            <kendo-grid-column [field]="gridSettings.columnsConfig[1].field"
              [width]="gridSettings.columnsConfig[1]._width" [title]="gridSettings.columnsConfig[1].title|translate"
              [filterable]="gridSettings.columnsConfig[1].filterable">
              <ng-template kendoGridCellTemplate let-dataItem>
                <a class="employee-link" [routerLink]="['/main/payroll/employee/edit', dataItem.Id]" target="_blank">
                  {{dataItem.FirstName}}
                </a>
              </ng-template>
            </kendo-grid-column>
            <kendo-grid-column [field]="gridSettings.columnsConfig[2].field"
              [width]="gridSettings.columnsConfig[2]._width" [title]="gridSettings.columnsConfig[2].title|translate"
              [filterable]="gridSettings.columnsConfig[2].filterable">
              <ng-template kendoGridCellTemplate let-dataItem>
                <a class="employee-link" [routerLink]="['/main/payroll/employee/edit', dataItem.Id]" target="_blank">
                  {{dataItem.LastName}}
                </a>
              </ng-template>
            </kendo-grid-column>
          </kendo-grid>
          <div *ngIf="showErrorMessage===true" class="error-message" style="color:red">
            {{'EMPLOYEE_MUST_BE_SELECTED'|translate}}
          </div>
        </div>
    </div>
    <!--Begin Card footer Start-->
    <div class="fixed-card-footer">
      <div class="footerStyle">
        <footer class="app-footer ml-0">
          <div class="w-100">
            <div class="d-flex justify-content-end p-3 footer-content">


              <a routerLink="{{'/main/payroll/transferorder'}}">
                <span class="btn btn-sm btn-back-to-list btn-primary ">
                  <i class="fa fa-chevron-circle-left"></i> {{'BACK_TO_LIST'|translate}}
                </span>
              </a>

              <button class="btn btn-sm btn-save mx-1 previous" (click)="onPreviousClik()">
                <i class="fa fa-angle-left"></i> {{'PREVIOUS'|translate}}
              </button>
              <button *ngIf="hasCloseTransferOrderPermission && transferOrder.State !== transferOrderStatus.Closed" class="btn btn-sm btn-primary next"
                type="submit" (click)="closeTransferOrderClick()">
                <i class="fa fa-floppy-o"></i> {{'CLOSE_Transfer_ORDER'|translate}}
              </button>
              <!--print-->
              <button *ngIf="hasPrintPermission && transferOrder.State !== transferOrderStatus.InProgress" class="btn btn-primary btn-sm"
                (click)="onPrintClick(transferOrder)">
                <i class="fa fa-print"></i>
                <span>&nbsp; {{'PRINT'|translate}}</span>
              </button>

            </div>
          </div>
        </footer>
      </div>
    </div>

  </div>
</div>
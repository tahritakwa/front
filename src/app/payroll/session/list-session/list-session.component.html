<div class="col-lg-12 col-md-12 col-sm-12">
  <div class="row">
    <div class="card border-0 full-screen-card">
      <div class="card-content">
        <div class="card-header" *ngIf="!isModal">
          <div class="col-sm-5 mt-1">
            <h3 class="card-title mb-0">{{'LISTSESSION'|translate}}</h3>
          </div>
        </div>
        <div class="card-body">
          <app-advanced-search [filtreFieldsColumns]="filtreFieldsColumns" [filtreFieldsInputs]="filtreFieldsInputs"
            (filtrePredicateToSend)="getFiltrePredicate($event)" (predicateOperator)="getOperatorPredicate($event)"
            (searchClickEvent)="initGridDataSource(false)" (resetClickEvent)="resetClickEvent()">
          </app-advanced-search>
          <div class="row d-flex justify-content-between mt-3">
            <app-search-session class="col-lg-3" (sendData)="receiveData($event)"></app-search-session>
            <app-btn-grid class="col" [advencedAdd]='hasOpenSessionPermission' [addLink]='"add"' [relativeStyle]='true' [model]="true" [isFromDocument]="true"
              [fileName]="'LIST_SESSION'|translate" [service]="sessionService" [predicate]="predicate" [gridSettings]="gridSettings"
              [isExportExcel]="true">
            </app-btn-grid>
          </div>
          <div class="col-lg-12 col-md-12 col-sm-12 px-0">
            <div class="mb-3" style="float: left;width: 100%">
              <div class="tab-pane active show" id="home1" role="tabpanel">
                <kendo-grid [data]="gridSettings.gridData" [pageSize]="gridSettings.state.take"
                  [skip]="gridSettings.state.skip" [sortable]="true" [pageable]="pagerSettings" filterable="menu"
                  [reorderable]="true" [columnMenu]="true" [sort]="gridSettings.state.sort"
                  [filter]="gridSettings.state.filter" [selectable]="true" (dataStateChange)="dataStateChange($event)">
                  <!-- Code -->
                  <kendo-grid-column [field]="gridSettings.columnsConfig[0].field"
                    [title]="gridSettings.columnsConfig[0].title | translate"
                    [width]="gridSettings.columnsConfig[0]._width" [filter]="gridSettings.columnsConfig[0].filter"
                    [filterable]="gridSettings.columnsConfig[0].filterable"
                    [format]="gridSettings.columnsConfig[0].format" [columnMenu]="false">
                    <ng-template kendoGridHeaderTemplate>
                      <span tooltip="{{gridSettings.columnsConfig[0].title|translate}}"
                        theme="light">{{gridSettings.columnsConfig[0].title|translate}}</span>
                    </ng-template>
                  </kendo-grid-column>
                  <!-- Title -->
                  <kendo-grid-column [field]="gridSettings.columnsConfig[1].field"
                    [title]="gridSettings.columnsConfig[1].title | translate"
                    [width]="gridSettings.columnsConfig[1]._width" [filter]="gridSettings.columnsConfig[1].filter"
                    [filterable]="gridSettings.columnsConfig[1].filterable"
                    [format]="gridSettings.columnsConfig[1].format" [columnMenu]="false">
                    <ng-template kendoGridHeaderTemplate>
                      <span tooltip="{{gridSettings.columnsConfig[1].title|translate}}"
                        theme="light">{{gridSettings.columnsConfig[1].title|translate}}</span>
                    </ng-template>
                  </kendo-grid-column>
                  <!--Month-->
                  <kendo-grid-column [field]=gridSettings.columnsConfig[2].field
                    [title]="gridSettings.columnsConfig[2].title | translate"
                    [width]="gridSettings.columnsConfig[2]._width" [filter]="gridSettings.columnsConfig[2].filter"
                    [filterable]="gridSettings.columnsConfig[2].filterable"
                    [format]="gridSettings.columnsConfig[2].format" [columnMenu]="false">
                    <ng-template kendoGridHeaderTemplate>
                      <span tooltip="{{gridSettings.columnsConfig[2].title|translate}}"
                        theme="light">{{gridSettings.columnsConfig[2].title|translate}}</span>
                    </ng-template>
                    <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                      {{dataItem.Month | date:'MMMM' | uppercase | translate }} {{dataItem.Month | date: 'yyyy'}}
                    </ng-template>
                  </kendo-grid-column>
                  <!--DependOnTimesheet-->
                  <kendo-grid-column [field]="gridSettings.columnsConfig[3].field"
                    [width]="gridSettings.columnsConfig[3]._width" [filter]="gridSettings.columnsConfig[3].filter"
                    [filterable]="gridSettings.columnsConfig[3].filterable"
                    [format]="gridSettings.columnsConfig[3].format" [columnMenu]="false">
                    <ng-template kendoGridHeaderTemplate>
                      <span tooltip="{{gridSettings.columnsConfig[3].title|translate}}"
                        theme="light">{{gridSettings.columnsConfig[3].title|translate}}</span>
                    </ng-template>
                    <ng-template kendoGridCellTemplate let-dataItem>
                      <div *ngIf="dataItem.DependOnTimesheet; then thenDependBlock else elseDependBlock"> </div>
                      <ng-template #thenDependBlock>
                        <span>{{'YES'|translate}}</span>
                      </ng-template>
                      <ng-template #elseDependBlock>
                        <span>{{'NO'|translate}}</span>
                      </ng-template>
                    </ng-template>
                  </kendo-grid-column>
                  <!--Days Of Work-->
                  <kendo-grid-column [field]="gridSettings.columnsConfig[4].field"
                    [title]="gridSettings.columnsConfig[4].title | translate"
                    [width]="gridSettings.columnsConfig[4]._width" [filter]="gridSettings.columnsConfig[4].filter"
                    [filterable]="gridSettings.columnsConfig[4].filterable"
                    [format]="gridSettings.columnsConfig[4].format" [columnMenu]="false">
                    <ng-template kendoGridHeaderTemplate>
                      <span tooltip="{{gridSettings.columnsConfig[4].title|translate}}"
                        theme="light">{{gridSettings.columnsConfig[4].title|translate}}</span>
                    </ng-template>
                    <ng-template kendoGridCellTemplate let-dataItem>
                      <div *ngIf="dataItem.DependOnTimesheet; then thenDependBlock else elseDependBlock"> </div>
                      <ng-template #thenDependBlock>
                        <span theme="light">{{dataItem.DaysOfWork}}</span>
                      </ng-template>
                      <ng-template #elseDependBlock>
                        <span tooltip="{{dataItem.DaysOfWeekWorked}}" theme="light">{{dataItem.DaysOfWork}}</span>
                      </ng-template>
                    </ng-template>
                  </kendo-grid-column>
                  <!-- State -->
                  <kendo-grid-column [field]="gridSettings.columnsConfig[5].field"
                    [title]="gridSettings.columnsConfig[5].title | translate"
                    [width]="gridSettings.columnsConfig[5]._width" [filter]="gridSettings.columnsConfig[5].filter"
                    [filterable]="gridSettings.columnsConfig[5].filterable"
                    [format]="gridSettings.columnsConfig[5].format" [columnMenu]="false">
                    <ng-template kendoGridHeaderTemplate>
                      <span tooltip="{{gridSettings.columnsConfig[5].title|translate}}"
                        theme="light">{{gridSettings.columnsConfig[5].title|translate}}</span>
                    </ng-template>
                    <ng-template kendoGridCellTemplate let-dataItem>
                      <div *ngIf="dataItem.State == payrollSessionState.Attendance"><span
                          class="badge badge-success">{{'ATTENDANCE'|translate}}</span></div>
                      <div *ngIf="dataItem.State == payrollSessionState.Bonus"><span
                          class="badge badge-warning">{{'BONUS'|translate}}</span></div>
                      <div *ngIf="dataItem.State == payrollSessionState.Loan"><span
                          class="badge badge-secondary">{{'LOAN'|translate}}</span></div>
                      <div *ngIf="dataItem.State == payrollSessionState.Payslip"><span
                          class="badge badge-primary">{{'PAYSLIP'|translate}}</span></div>
                      <div *ngIf="dataItem.State == payrollSessionState.Closed"><span
                          class="badge badge-danger">{{'CLOSED'|translate}}</span>
                      </div>
                    </ng-template>
                  </kendo-grid-column>
                  <!-- Command-->
                  <kendo-grid-command-column [width]="170" [title]="'ACTIONS'| translate " [columnMenu]="false"
                    [headerStyle]="{'text-align': 'center'}" [style]="{'text-align': 'center'}">
                    <ng-template kendoGridCellTemplate let-isNew="isNew" let-dataItem="dataItem">
                      <!-- edit command directive, will be visible when not in edit mode -->
                      <div *ngIf="dataItem.CanEdit == true; then thenCanEdit  else thenCanNotEdit"></div>
                      <ng-template #thenCanEdit>
                        <i (click)="getSession(dataItem.Id, dataItem.State)"
                          class="las la-pen cursor-pointer edit-pencil la-lg pr-1" tooltip="{{'UPDATE'|translate}}"></i>
                      </ng-template>
                      <ng-template #thenCanNotEdit>
                        <i (click)="getSession(dataItem.Id, dataItem.State)" class="las la-pen cursor-pointer edit-pencil la-lg"></i>
                      </ng-template>
                      <!-- remove command directive, will be visible when not in edit mode -->
                      <i *ngIf="dataItem.CanDelete && !canNotUpdatePays" (click)="removeSession(dataItem)"
                        class="fa fa-trash-o la-lg cursor-pointer text-danger" tooltip="{{'DELETE'|translate}}"></i>
                      <!-- save command directive, will be visible when in edit mode -->
                      <button kendoGridSaveCommand class="btnKendoGrid"><span class="fa fa-save"></span></button>
                      <!-- cancel command directive, will be visible when in edit mode -->
                      <button kendoGridCancelCommand class="btnKendoGrid"><span class="fa fa-close"></span></button>
                    </ng-template>
                  </kendo-grid-command-column>
                </kendo-grid>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>

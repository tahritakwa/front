<div class="card">
  <!--Begin Card eader-->
  <div *ngIf="!isModal" class="card-header">
    <div class="col-sm-5 mt-1">
      <h3 class="card-title mb-0,00">{{ 'SOURCE_DEDUCTION_SESSION' |translate }}
      </h3>
    </div>
  </div>
  <!--End Card header-->
  <!--Begin add form-->
  <form [formGroup]="sourceDeductionSessionFormGroup" class="form-horizontal">
    <!--Begin Card body-->
    <div class="card-body">
      <!--Begin add form-->
      <div class="col-lg-12 col-sm-12 col-md-12 ">
        <div class="form-group row">
          <div class="col-sm-12 col-md-3 col-lg-3">
            <label class="col-lg-12 col-md-12 col-sm-12"> {{'CODE'|translate}}</label>
            <input class="form-control" disabled formControlName="Code" name="">
          </div>
          <div class="col-sm-12 col-md-5 col-lg-5">
            <label class="col-lg-12 col-md-12 col-sm-12"> {{'TITLE'|translate}}<span class="required">*</span></label>
            <input [ngClass]="{ 'has-error': (Title.touched || Title.dirty) && !Title.valid }" class="form-control" formControlName="Title" name=""
                   type="text">
            <app-control-messages [control]="Title" class="error-msg messages text-left text-danger">
            </app-control-messages>
          </div>
          <div class="col-lg-4 col-md-6 col-sm-12">
            <label class="col-lg-12 col-md-12 col-sm-12"> {{'YEAR'|translate}}</label>
            <kendo-datepicker (valueChange)="onClickInitialiseDate()" [bottomView]="'decade'" [format]="'yyyy'" class="form-control"
                              formControlName="Year">
              <kendo-datepicker-messages today="{{ 'TODAY' | translate}}" toggle="Cambiar calendario">
              </kendo-datepicker-messages>
            </kendo-datepicker>
            <app-control-messages [control]="Year" class="error-msg messages text-left text-danger">
            </app-control-messages>
          </div>
        </div>
      </div>
      <!--End add form-->
      <!--Begin Employee List-->
      <div class="col-lg-12 col-sm-12 col-md-12" style="margin-top:60px">
        <kendo-grid (dataStateChange)="dataStateChange($event)" (selectedKeysChange)="onSelectedKeysChange($event)"
                    [data]="gridSettings.gridData" [filter]="gridSettings.state.filter" [kendoGridSelectBy]="'Id'" [pageSize]="gridSettings.state.take" [pageable]="true"
                    [reorderable]="true"
                    [selectable]="{enabled: true, checkboxOnly: true}"
                    [selectedKeys]="employeesIdsSelected" [skip]="gridSettings.state.skip"
                    [sort]="gridSettings.state.sort" [sortable]="true">
          <kendo-grid-checkbox-column *ngIf="(hasUpdatePermission || (hasAddPermission && !isUpdateMode)) && !isClosed" [width]="100">
            <ng-template kendoGridHeaderTemplate>
              <input (selectAllChange)="onSelectAllChange($event)" [state]="selectAllState" class="k-checkbox" id="selectAllCheckboxId"
                     kendoGridSelectAllCheckbox>
              <label class="k-checkbox-label" for="selectAllCheckboxId"></label>
            </ng-template>
          </kendo-grid-checkbox-column>
          <!-- Matricule -->
          <kendo-grid-column [field]="gridSettings.columnsConfig[0].field"
                             [filter]="gridSettings.columnsConfig[0].filter"
                             [filterable]="gridSettings.columnsConfig[0].filterable"
                             [format]="gridSettings.columnsConfig[0].format"
                             [width]="gridSettings.columnsConfig[0]._width">
            <ng-template kendoGridHeaderTemplate>
              <span theme="light"
                    tooltip="{{gridSettings.columnsConfig[0].title|translate}}">{{gridSettings.columnsConfig[0].title|translate}}</span>
            </ng-template>
          </kendo-grid-column>
          <!-- Nom -->
          <kendo-grid-column [field]="gridSettings.columnsConfig[1].field"
                             [filter]="gridSettings.columnsConfig[1].filter"
                             [filterable]="gridSettings.columnsConfig[1].filterable"
                             [format]="gridSettings.columnsConfig[1].format"
                             [width]="gridSettings.columnsConfig[1]._width">
            <ng-template kendoGridHeaderTemplate>
              <span theme="light"
                    tooltip="{{gridSettings.columnsConfig[1].title|translate}}">{{gridSettings.columnsConfig[1].title|translate}}</span>
            </ng-template>
            <ng-template kendoGridCellTemplate let-dataItem>
              <a [routerLink]="['/main/payroll/employee/edit', dataItem.Id]" class="employee-link" target="_blank">
                {{dataItem.FirstName}}
              </a>
            </ng-template>
          </kendo-grid-column>
          <!-- Prenom -->
          <kendo-grid-column [field]="gridSettings.columnsConfig[2].field"
                             [filter]="gridSettings.columnsConfig[2].filter"
                             [filterable]="gridSettings.columnsConfig[2].filterable"
                             [format]="gridSettings.columnsConfig[2].format"
                             [width]="gridSettings.columnsConfig[2]._width">
            <ng-template kendoGridHeaderTemplate>
              <span theme="light"
                    tooltip="{{gridSettings.columnsConfig[2].title|translate}}">{{gridSettings.columnsConfig[2].title|translate}}</span>
            </ng-template>
            <ng-template kendoGridCellTemplate let-dataItem>
              <a [routerLink]="['/main/payroll/employee/edit', dataItem.Id]" class="employee-link" target="_blank">
                {{dataItem.LastName}}
              </a>
            </ng-template>
          </kendo-grid-column>
        </kendo-grid>
        <div *ngIf="showErrorMessage===true" class="error-message" style="color:red">
          {{'EMPLOYEE_MUST_BE_SELECTED'|translate}}
        </div>
      </div>
      <!--End Employee List-->
    </div>
    <!--End Card body-->
    <!--Begin Card footer-->
    <div class="fixed-card-footer">
      <div class="footerStyle">
        <footer class="app-footer ml-0">
          <div class="w-100">
            <div class="d-flex justify-content-end p-3 footer-content">
              <button [routerLink]="['/main/payroll/sourcedeductionsession']" class="btn btn-sm btn-primary btn-back-to-list" #BackToList>
                <i class="fa fa-chevron-circle-left"></i> {{'BACK_TO_LIST'|translate}}
              </button>
              <button (click)="onAddSessionClick()" class="btn btn-sm btn-success mx-1" type="submit">
                  <i *ngIf = "isUpdateMode" class="fa fa-angle-right"></i>
                  <i *ngIf = "!isUpdateMode" class="fa fa-floppy-o"></i>
                  {{(isUpdateMode ? 'NEXT' : 'ADD')|translate}}
              </button>
            </div>
          </div>
        </footer>
      </div>
    </div>
    <!--End Card footer-->
  </form>
  <!--End add form-->
</div>

<div class="col-lg-12 col-md-12 col-sm-12">
  <div class="row">
    <div class="card border-0 full-screen-card">
      <div class="card-content">
        <div class="card-header" *ngIf="!isModal">
          <div class="col-sm-5 mt-1">
            <h3 class="card-title mb-0">{{'LIST_SOURCE_DEDUCTION_SESSION'|translate}}</h3>
          </div>
        </div>
        <div class="card-body">
          <app-advanced-search [filtreFieldsColumns]="filtreFieldsColumns" [filtreFieldsInputs]="filtreFieldsInputs"
            (filtrePredicateToSend)="getFiltrePredicate($event)" (predicateOperator)="getOperatorPredicate($event)"
            (searchClickEvent)="initGridDataSource(false)" (resetClickEvent)="resetClickEvent()">
          </app-advanced-search>
          <div class="row d-flex justify-content-between mt-3">
            <app-search-session class="col-lg-3" (sendData)="receiveData($event)"></app-search-session>
            <app-btn-grid class="col" [advencedAdd]='hasAddPermission' [addLink]='"add"' [relativeStyle]='true' [model]="true"
              [fileName]="'LIST_SOURCE_DEDUCTION_SESSION'|translate" [service]="sourceDeductionSessionService"
              [isFromDocument]="true" [predicate]="predicate" [isExportExcel]="true" [gridSettings]="gridSettings">
            </app-btn-grid>
          </div>
          <kendo-grid [data]="gridSettings.gridData" [pageSize]="gridSettings.state.take"
            [skip]="gridSettings.state.skip" [sortable]="true" [pageable]="pagerSettings" filterable="menu"
            [reorderable]="true" [columnMenu]="true" [sort]="gridSettings.state.sort"
            [filter]="gridSettings.state.filter" [selectable]="true" (dataStateChange)="dataStateChange($event)">
            <!--Session number-->
            <kendo-grid-column [field]="gridSettings.columnsConfig[0].field"
              [title]="gridSettings.columnsConfig[0].title | translate" [width]="gridSettings.columnsConfig[0]._width"
              [filter]="gridSettings.columnsConfig[0].filter" [filterable]="gridSettings.columnsConfig[0].filterable"
              [format]="gridSettings.columnsConfig[0].format" [columnMenu]="false">
              <ng-template kendoGridHeaderTemplate>
                <span tooltip="{{gridSettings.columnsConfig[0].title|translate}}"
                  theme="light">{{gridSettings.columnsConfig[0].title|translate}}</span>
              </ng-template>
            </kendo-grid-column>
            <!-- Title -->
            <kendo-grid-column [field]="gridSettings.columnsConfig[1].field"
              [title]="gridSettings.columnsConfig[1].title | translate" [width]="gridSettings.columnsConfig[1]._width"
              [filter]="gridSettings.columnsConfig[1].filter" [filterable]="gridSettings.columnsConfig[1].filterable"
              [format]="gridSettings.columnsConfig[1].format" [columnMenu]="false">
              <ng-template kendoGridHeaderTemplate>
                <span tooltip="{{gridSettings.columnsConfig[1].title|translate}}"
                  theme="light">{{gridSettings.columnsConfig[1].title|translate}}</span>
              </ng-template>
            </kendo-grid-column>
            <!--Year-->
            <kendo-grid-column [field]=gridSettings.columnsConfig[2].field
              [title]="gridSettings.columnsConfig[2].title | translate" [width]="gridSettings.columnsConfig[2]._width"
              [filter]="gridSettings.columnsConfig[2].filter" [filterable]="gridSettings.columnsConfig[2].filterable"
              [format]="gridSettings.columnsConfig[2].format" [columnMenu]="false" [columnMenu]="false">
              <ng-template kendoGridHeaderTemplate>
                <span tooltip="{{gridSettings.columnsConfig[2].title|translate}}"
                  theme="light">{{gridSettings.columnsConfig[2].title|translate}}</span>
              </ng-template>
            </kendo-grid-column>
            <kendo-grid-command-column [width]="170" [title]="'ACTIONS'| translate " [columnMenu]="false"
              [headerStyle]="{'text-align': 'center'}" [style]="{'text-align': 'center'}">
              <ng-template kendoGridCellTemplate let-isNew="isNew" let-dataItem="dataItem">
                <!-- edit command directive, will be visible when not in edit mode -->
                <div *ngIf="dataItem.State !== sessionState.Closed; then notClosed  else isClosed"></div>
                <ng-template #notClosed>
                  <i class="k-button btnKendoGrid editBtn" *ngIf="hasShowPermission || hasUpdatePermission" (click)="getSession(dataItem.Id)"
                    class="las la-pen cursor-pointer edit-pencil la-lg pr-1" tooltip="{{'UPDATE'|translate}}"></i>
                  <!-- remove command directive, will be visible when not in edit mode -->
                  <i class="btnKendoGrid" *ngIf="hasDeletePermission" (click)="removeHandler(dataItem)"
                    class="fa fa-trash-o la-lg cursor-pointer text-danger" tooltip="{{'DELETE'|translate}}"></i>
                </ng-template>
                <ng-template #isClosed>
                  <i class="btnKendoGrid" (click)="getSession(dataItem.Id)"
                    class="las la-pen cursor-pointer edit-pencil la-lg"></i>
                </ng-template>
                <!-- save command directive, will be visible when in edit mode -->
                <button kendoGridSaveCommand class="btnKendoGrid"><span class="fa fa-save"></span></button>
                <!-- cancel command directive, will be visible when in edit mode -->
                <button kendoGridCancelCommand class="btnKendoGrid"><span class="fa fa-close"
                    *ngIf="hasDeletePermission"></span></button>
              </ng-template>
            </kendo-grid-command-column>
            <!-- column select -->
            <kendo-grid-command-column [width]="50" [columnMenu]="true">
            </kendo-grid-command-column>
            <!--End Columns-->
          </kendo-grid>
        </div>
      </div>
    </div>
  </div>
</div>

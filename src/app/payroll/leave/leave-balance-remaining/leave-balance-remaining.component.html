<div class="card">
  <div class="card-header">
    <div class="col-sm-5 mt-1">
      <h3 class="card-title mb-0">{{'LEAVE_REMAINING_BALANCE_LIST'|translate}}</h3>
    </div>
  </div>
  <!-- Header Start -->
  <div class="row" style="margin-top:3em">
    <div class="col-lg-3 col-md-3 col-sm-3" style="margin-left: 26em;">
      {{'EMPLOYEES'|translate}}
      <div style="margin-bottom:10px">
        <app-employee-multiselect (selected)="employeeSelected($event)"></app-employee-multiselect>
      </div>
    </div>
    <div class="col-lg-3 col-md-3 col-sm-3">
      {{'LEAVE_TYPE'|translate}}
      <div style="margin-bottom:10px">
        <app-leave-type-dropdown (Selected)="leaveTypeSelected($event)" [group]="statusSearchDropdownFormGroup"
        ></app-leave-type-dropdown>
      </div>
    </div>
  </div>
  <!-- Header End -->
  <div class="card-body">
    <form class="form-horizontal">
      <div align="right" class="col-lg-12 col-md-12 col-sm-12 col-sx-12">
        <button *ngIf="hasCalculatePermission" (click)="calculateLeaveBalanceRemaining()" class="k-button btn-secondary ml-3 mr-2" tabindex="0"
                type="button">
          <i class="fa fa-refresh fa-lg AddIcon"></i>
          <span>&nbsp;{{'UPDATE_LEAVE_REMAINING_BALANCE_DATA' | translate}}</span>
        </button>
        <a (click)="sendEmailToAllEmployees()" *ngIf="hasSendLeaveBalanceRemainingPermission"
           class="k-button btn-secondary ml-3 mr-2">
          <i class="fa fa-share fa-sm AddIcon"></i>
          <span>&nbsp; {{'LEAVE_BALANCE_EMAIL_TO_ALL_EMPLOYEES'|translate}}</span>
        </a>
      </div>
      <br>
      <kendo-grid (dataStateChange)="dataStateChange($event)" [data]="gridSettings.gridData"
                  [pageSize]="gridState.take" [pageable]="pagerSettings"
                  [selectable]="true" [skip]="gridState.skip">
        <ng-template kendoGridToolbarTemplate>
          <div *ngIf="hasCalculatePermission && showProgress">
            <app-progress-bar [progress]="progression"></app-progress-bar>
          </div>
        </ng-template>
        <!--Employee-->
        <kendo-grid-column [headerStyle]="{'background-color':'rgb(247 246 246)' }"
                           [locked]="true"
                           [title]="generiqueColumnConfig[1].title | translate" [width]="generiqueColumnConfig[1]._width">
          <ng-template kendoGridCellTemplate let-dataItem='dataItem'>
            {{dataItem.Employee.FullName}}
          </ng-template>
        </kendo-grid-column>
        <!--Columns-->
        <ng-container *ngFor="let col of columnsTypeLeaveConfig">
          <kendo-grid-column-group [locked]="false"
                                   [title]="col.title">
            <ng-template kendoGridHeaderTemplate>
              <div style="text-align:center">{{col.title}}</div>
            </ng-template>
            <kendo-grid-column [title]="columnsConfig[0].title | translate" [width]="col._width">
              <ng-template kendoGridHeaderTemplate>
                        <span theme="light"
                              tooltip="{{columnsConfig[0].tooltip|translate}}">{{columnsConfig[0].title|translate}}</span>
              </ng-template>
              <ng-template kendoGridCellTemplate let-dataItem>
                      <span [ngStyle]="{'color': (dataItem.leaveBalanceRemainingList[col.key].CumulativeAcquired && dataItem.leaveBalanceRemainingList[col.key].CumulativeAcquired.Day >= 0
                          && dataItem.leaveBalanceRemainingList[col.key].CumulativeAcquired.Hour >= 0) ? 'black' : 'red' }">
                        {{ dataItem.leaveBalanceRemainingList[col.key].CumulativeAcquired.Day}} {{'DAY_ABBREVIATED' | translate}}
                        {{dataItem.leaveBalanceRemainingList[col.key].CumulativeAcquired.Hour}} {{'HOUR_ABBREVIATED' | translate}}</span>
              </ng-template>
            </kendo-grid-column>
            <kendo-grid-column [title]="columnsConfig[1].title | translate" [width]="col._width">
              <ng-template kendoGridHeaderTemplate>
                          <span theme="light"
                                tooltip="{{columnsConfig[1].tooltip|translate}}">{{columnsConfig[1].title|translate}}</span>
              </ng-template>
              <ng-template kendoGridCellTemplate let-dataItem>
                        <span [ngStyle]="{'color': (dataItem.leaveBalanceRemainingList[col.key].CumulativeTaken && dataItem.leaveBalanceRemainingList[col.key].CumulativeTaken.Day >= 0
                          && dataItem.leaveBalanceRemainingList[col.key].CumulativeTaken.Hour >= 0) ? 'black' : 'red' }">
                        {{ dataItem.leaveBalanceRemainingList[col.key].CumulativeTaken.Day}} {{'DAY_ABBREVIATED' | translate}}
                          {{dataItem.leaveBalanceRemainingList[col.key].CumulativeTaken.Hour}} {{'HOUR_ABBREVIATED' | translate}}</span>
              </ng-template>
            </kendo-grid-column>
            <kendo-grid-column [title]="columnsConfig[2].title | translate" [width]="col._width">
              <ng-template kendoGridHeaderTemplate>
                            <span theme="light"
                                  tooltip="{{columnsConfig[2].tooltip|translate}}">{{columnsConfig[2].title|translate}}</span>
              </ng-template>
              <ng-template kendoGridCellTemplate let-dataItem>
                          <span [ngStyle]="{'color': (dataItem.leaveBalanceRemainingList[col.key].RemainingBalance && dataItem.leaveBalanceRemainingList[col.key].RemainingBalance.Day >= 0
                              && dataItem.leaveBalanceRemainingList[col.key].RemainingBalance.Hour >= 0) ? 'black' : 'red' }">
                            {{ dataItem.leaveBalanceRemainingList[col.key].RemainingBalance.Day}} {{'DAY_ABBREVIATED' | translate}}
                            {{dataItem.leaveBalanceRemainingList[col.key].RemainingBalance.Hour}} {{'HOUR_ABBREVIATED' | translate}}</span>
              </ng-template>
            </kendo-grid-column>
            <!-- Command-->
            <kendo-grid-command-column [width]="50">
            </kendo-grid-command-column>
          </kendo-grid-column-group>
        </ng-container>
      </kendo-grid>
    </form>
  </div>
</div>

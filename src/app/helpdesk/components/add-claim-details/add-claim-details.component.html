<div *ngIf='parent'>
  <div class="animated fadeIn">
    <div class="row">
      <div class="col-lg-12 col-sm-12 col-md-12 col-xs-12">
        <form class="form-horizontal" [formGroup]="parent">
          <div class="card">
            <div class="card-body">
              <div class="row mt-3">
                <ng-container >
                  <div class="col-lg-3 col-md-6 col-sm-12">
                    <div class="row">
                      <label class="col-lg-12 col-md-12 col-sm-12">{{getTierTypeLabel()|translate}} <span
                        class="required">*</span></label>
                      <div class="col-lg-12 col-md-12 col-sm-12">
                        <app-supplier-dropdown *ngIf="(claimServices.authorizedToUpdate && hasUpdatePermission )|| (claimServices.authorizedToUpdate && hasAddPermission)"
                                               [type]=tierType [itemForm]="parent" [placeholder]="tierTypePlaceHolder"
                                               (Selected)="receiveClaimSupplierSelected($event)"
                                               [getRelationCurrency]='false' class="error-msg messages text-left text-danger"
                                               [hideAddBtn]="true">
                        </app-supplier-dropdown>
                        <input *ngIf="!claimServices.authorizedToUpdate || !hasUpdatePermission && !hasAddPermission " class="form-control"
                               formControlName="IdTiersReference" type="text">
                        <app-control-messages [control]="parent.controls.IdTiers"
                                              class="error-msg messages text-left text-danger">
                        </app-control-messages>
                      </div>
                    </div>
                  </div>
                </ng-container>
                <div class="col-lg-3 col-md-6 col-sm-12">
                  <div class="row">
                    <label class="col-lg-12 col-md-12 col-sm-12">{{'ITEM'|translate}} <span class="required">*</span></label>
                    <div class="col-lg-12 col-md-10 col-sm-10">
                      <ng-container>
                        <app-item-dropdown *ngIf="(claimServices.authorizedToUpdate && hasUpdatePermission) || (claimServices.authorizedToUpdate && hasAddPermission)" [itemForm]="parent"
                                           [parentViewContainerRef]="viewRef" [showFilter]='true' (FocusOut)="itemFocusOut($event)"
                                           (Selected)="itemSelect($event)" [activeKeyPress]='true' [isForSales]='false'
                                           [hideSearch]="hideSearch" [tiersAssociated]="listOfTiers" [isFroSerach]='true'  [isOnlyStockManaged]="true"
                                           [removeFilter]='false' #itemList>
                        </app-item-dropdown>
                        <input *ngIf="!claimServices.authorizedToUpdate || !hasUpdatePermission &&!hasAddPermission " class="form-control"
                               formControlName="IdItemReference" type="text">
                        <app-control-messages [control]="parent.controls.IdItem"
                                              class="error-msg messages text-left text-danger">
                        </app-control-messages>
                      </ng-container>
                    </div>
                  </div>
                </div>
                <ng-container *ngIf="claimDetailsType === 'D' ">
                <div  class="col-lg-3 col-md-6 col-sm-12">
                  <div class="row">

                <label class="col-lg-12 col-md-12 col-sm-12">{{ "SUPPLIERS" | translate
                }}<span class="required" >*</span></label>
              <div class="col-lg-12 col-md-12 col-sm-12">

                <app-supplier-dropdown  [disabled]="!claimServices.authorizedToUpdate || !hasUpdatePermission && !hasAddPermission" [itemForm]="claimAddTierForm" [type]=2 [TecDocSupp]="TecDocSupp" [isSwhoOnlySelected]= "isSwhoOnlySelected"
                  [isMultiSelect]="false" [isCheckboxMode]="false" [isForAddProduct]="false" [supplierDataSource]="listTiers" [supplierFiltredDataSource]="listTiers"
                  (selectedTiersId)="selectedValue($event)"  [hideAddBtn]="true">
                </app-supplier-dropdown>
                <app-control-messages [control]="parent.controls.IdFournisseur" class="error-msg messages text-left text-danger">
                </app-control-messages>
</div>
</div>
</div>
</ng-container>
                <div class="col-lg-3 col-md-6 col-sm-12">
                  <div class="row">
                    <label class="col-lg-12 col-md-12 col-sm-12">{{'QUANTITY'|translate}} <span
                      class="required">*</span> </label>
                    <div class="col-lg-12 col-md-12 col-sm-12">
                      <input class="form-control" formControlName="ClaimQty" type="number" name="ClaimQty"
                        inputType="number"
                        [ngClass]="{ 'has-error': (parent.controls.ClaimQty.touched || parent.controls.ClaimQty.dirty)
                          && (!parent.controls.ClaimQty.valid && !parent.controls.ClaimQty.disabled)}">
                      <app-control-messages [control]="parent.controls.ClaimQty"
                                            class="error-msg messages text-left text-danger">
                      </app-control-messages>
                    </div>
                  </div>
                </div>

              </div><br />

              <div class="row">

                <div class="col-lg-12 col-md-6 col-sm-12">
                  <div class="row">
                    <ng-container *ngIf="claimDetailsType === 'D' ">
                      <label class="col-lg-12 col-md-12 col-sm-12"> {{'CLAIM_CLIENT_DESCRIPTION'|translate}} <span
                        class="required">*</span> </label>
                    </ng-container>
                    <ng-container *ngIf="claimDetailsType !== 'D' ">
                      <label class="col-lg-12 col-md-12 col-sm-12"> {{'CLAIM_SUPPLIER_DESCRIPTION'|translate}} <span
                        class="required">*</span> </label>
                    </ng-container>
                    <div class="col-lg-12 col-md-12 col-sm-12">
                      <textarea class="form-control" formControlName="Description" type="text"
                                [ngClass]="{ 'has-error': (parent.controls.Description.touched || parent.controls.Description.dirty) && !parent.controls.Description.valid }"></textarea>
                      <app-control-messages [control]="parent.controls.Description"
                                            class="error-msg messages text-left text-danger">
                      </app-control-messages>
                    </div>
                  </div>
                </div><br />
              </div><br /><br />


              <ng-container *ngIf="claimDetailsType !== 'D' && claimServices.enableAllButton">
                <div class="row">
                  <div class="col-lg-12 col-md-6 col-sm-12">
                    <div class="row">
                      <div class="col-lg-6 col-md-6 col-sm-12">
                        <div class="row">
                          <div *ngIf="showStockMovementIn && haveGeneratePermission">
                            <label class="col-lg-4 col-md-12 col-sm-12"></label>
                            <span class="col-md-12 col-sm-12">
                              <button type="button" class="btn btn-sm btn-warning" (click)="generateMovementIn()"
                                      [disabled]="claimServices.disableButtonWhenTreatment">
                                <span>
                                  <i class="fa fa-check-square-o"></i> {{'GENERATE_CLAIM_STOCKMOVEMENT_IN'|translate}}
                                </span>
                              </button>
                            </span>
                          </div>
                          <div *ngIf="showStockMovementOut && haveGeneratePermission">
                            <label class="col-lg-4 col-md-12 col-sm-12"></label>
                            <span class="col-md-12 col-sm-12">
                              <button type="button" class="btn btn-sm btn-warning" (click)="generateMovementOut()"
                                      [disabled]="claimServices.disableButtonWhenTreatment">
                                <span>
                                  <i class="fa fa-check-square-o"></i> {{'GENERATE_CLAIM_STOCKMOVEMENT_OUT'|translate}}
                                </span>
                              </button>
                            </span>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div><br />



                </div><br /><br />
                <!-- <div class="row" *ngIf="claimServices.movementDocument !== null && claimServices.movementDocument !== undefined">
                  <div>
                    <span *ngIf="claimDetailsType === 'M'">{{'GENERATED_BS'|translate}}: </span>
                    <span *ngIf="claimDetailsType === 'E'">{{'GENERATED_BE'|translate}}: </span></div>
                  <label class="col-lg-4 col-md-12 col-sm-12">
                    <span>
                      <a class="grid-cell-link" (click)="onClickGoToDocument(claimServices.movementDocument.DocumentTypeCode,
                      claimServices.movementDocument.IdDocumentStatus, claimServices.movementDocument.Id)">
                        {{ claimServices.movementDocument.Code }} </a>
                    </span>
                  </label>
                </div> -->
              </ng-container>

              <ng-container *ngIf="(claimDetailsType === 'D') && claimServices.enableAllButton">
                <div class="row">
                  <div class="col-lg-12 col-md-12 col-sm-12">
                    <div class="row">
                      <div class="col-lg-12 col-md-12 col-sm-12">
                        <!--Deffective first action-->
                        <!--Has documents-->
                        <div class="row"
                             *ngIf="!claimServices.hasOnlyOldDocument
                        && (claimServices.hasSaleDeliveryToUpdate || claimServices.hasSaleInvoiceToGenerateSaleAsset || claimServices.hasBSToUpdate)">
                          <input type="radio" name="deffective-document" id="new-document"
                                 [checked]='claimServices.checkNewButton' (click)="showNewDocument()" />
                          <label for="new-document">&nbsp;</label>
                          <br /><br />

                          <div class="col-lg-6 col-md-12 col-sm-12"
                               *ngIf="claimServices.hasSaleDeliveryToUpdate && claimServices.authorizedToUpdate && haveGeneratePermission">
                            <span class="col-lg-6 col-md-12 col-sm-12">
                              <button type="button" class="btn btn-sm btn-warning"
                                      (click)="updateSaleDeliveryDocument()"
                                      [disabled]="claimServices.disableButtonWhenTreatment || !claimServices.disableOldButton">
                                <span>
                                  <i class="fa fa-check-square-o"></i> {{ ((claimServices.saleDeliveryDocument.DocumentTypeCode == documentEnumerator.SalesDelivery) ? 'UPDATE_CLAIM_SALES_DELIVERY' : 'GENERATE_SALES_ASSET')|translate}}
                                </span>
                              </button>
                            </span>
                            <label class="col-lg-6 col-md-6 col-sm-6">
                              <span>
                                <a class="grid-cell-link"
                                   (click)="onClickGoToDocument(claimServices.saleDeliveryDocument.DocumentTypeCode,
                                  claimServices.saleDeliveryDocument.IdDocumentStatus, claimServices.saleDeliveryDocument.Id)">
                                  {{ claimServices.saleDeliveryDocument.Code }} </a>
                              </span>
                            </label>
                          </div>
                          <div class="col-lg-6 col-md-12 col-sm-12"
                               *ngIf="claimServices.hasSaleInvoiceToGenerateSaleAsset && claimServices.authorizedToUpdate">
                            <span class="col-lg-6 col-md-12 col-sm-12">
                              <button type="button" class="btn btn-sm btn-warning" (click)="generateSaleAssetDocument()"
                                      [disabled]="claimServices.disableButtonWhenTreatment || !claimServices.disableOldButton">
                                <span>
                                  <i class="fa fa-check-square-o"></i> {{'GENERATE_CLAIM_SALE_ASSET'|translate}}
                                </span>
                              </button>
                            </span>
                            <label class="col-lg-4 col-md-12 col-sm-12">
                              <span>
                                <a class="grid-cell-link"
                                   (click)="onClickGoToDocument(claimServices.saleInvoiceDocument.DocumentTypeCode,
                                                    claimServices.saleInvoiceDocument.IdDocumentStatus, claimServices.saleInvoiceDocument.Id)">
                                  {{ claimServices.saleInvoiceDocument.Code }} </a>
                              </span>
                            </label>
                          </div>
                          <div class="col-lg-6 col-md-12 col-sm-12"
                               *ngIf="claimServices.hasBSToUpdate && claimServices.authorizedToUpdate">
                            <span class="col-lg-6 col-md-12 col-sm-12">
                              <button type="button" class="btn btn-sm btn-warning" (click)="updateBSDocument()"
                                      [disabled]="claimServices.disableButtonWhenTreatment || !claimServices.disableOldButton">
                                <span>
                                  <i class="fa fa-check-square-o"></i> {{'UPDATE_CLAIM_BS'|translate}}
                                </span>
                              </button>
                            </span>
                            <label class="col-lg-4 col-md-12 col-sm-12">
                              <span>
                                <a class="grid-cell-link"
                                   (click)="onClickGoToDocument(claimServices.bSDocumentToUpdate.DocumentTypeCode,
                                  claimServices.bSDocumentToUpdate.IdDocumentStatus, claimServices.bSDocumentToUpdate.Id)">
                                  {{ claimServices.bSDocumentToUpdate.Code }} </a>
                              </span>
                            </label>
                          </div>
                        </div>

                        <div class="row"
                             *ngIf="!claimServices.hasOnlyOldDocument
                        && (claimServices.hasSaleDeliveryToUpdate || claimServices.hasSaleInvoiceToGenerateSaleAsset || claimServices.hasBSToUpdate)">
                          <input type="radio" name="deffective-document" id="old-document"
                                 (click)="showOldDocument()" />
                          <label for="old-document">&nbsp;&nbsp;&nbsp;&nbsp;{{'OLD_DOCUMENT'|translate}}</label>
                          <br /><br />

                          <div class="col-lg-4 col-md-4 col-sm-12">
                            <input class="form-control" formControlName="ReferenceOldDocument" type="text"
                                   [ngClass]="{ 'has-error': (parent.controls.ReferenceOldDocument.touched || parent.controls.ReferenceOldDocument.dirty) && !parent.controls.ReferenceOldDocument.valid }">
                            <app-control-messages [control]="parent.controls.ReferenceOldDocument"
                                                  class="error-msg messages text-left text-danger">
                            </app-control-messages>
                          </div>
                        </div>

                        <!--Deffective second action-->
                        <div class="row">
                          <!--input old reference-->
                          <div class="col-lg-4 col-md-4 col-sm-12" *ngIf="claimServices.hasOnlyOldDocument ">
                            <label class="col-lg-12 col-md-12 col-sm-12"> {{'OLD_DOCUMENT'|translate}} <span
                              class="required">*</span> </label>
                            <input class="form-control" formControlName="ReferenceOldDocument" type="text"
                              [ngClass]="{ 'has-error': (parent.controls.ReferenceOldDocument.touched || parent.controls.ReferenceOldDocument.dirty)
                                && (!parent.controls.ReferenceOldDocument.valid && !parent.controls.ReferenceOldDocument.disabled) }">
                            <app-control-messages [control]="parent.controls.ReferenceOldDocument"
                                                  class="error-msg messages text-left text-danger">
                            </app-control-messages>
                          </div>
                          <div class="col-lg-6 col-md-12 col-sm-12" *ngIf="showStockMovementOutOfDeffective"
                               style="padding-top: 25px;">
                            <div class="row">
                              <span class="col-lg-6 col-md-12 col-sm-12">
                                <button type="button" class="btn btn-sm btn-warning" (click)="generateMovementOut()"
                                        [disabled]="claimServices.disableButtonWhenTreatment">
                                  <span>
                                    <i class="fa fa-check-square-o"></i>
                                    {{'GENERATE_CLAIM_STOCKMOVEMENT_OUT'|translate}}
                                  </span>
                                </button>
                              </span>

                            </div>
                          </div>
                        </div>
                      </div>
                    </div>
                  </div><br />
                </div><br /><br />
              </ng-container>
              <br />
            </div>

          </div>
        </form>
      </div>
    </div>
  </div>
</div>

<div class="card full-screen-card">
  <!-- card-header -->
  <div class="card-header">
    <div class="row">
      <div class="col-sm-5 mt-1">
        <h3>{{'INTERVENTIONS'|translate}}</h3>
      </div>
    </div>
  </div>
  <!-- card-body -->
  <div class="card-body">
    <!-- Advanced search-->
    <div class="col-lg-12 col-sm-12 col-md-12">
      <app-advanced-search [filtreFieldsColumns]="filterFieldsColumns" [filtreFieldsInputs]="filterFieldsInputs"
       (filtrePredicateToSend)="getFiltrePredicate($event)"
        (filterFieldsInputsChange)="filterFieldsInputsChange($event)" (searchClickEvent)="searchClick()"
        (resetClickEvent)="resetClickEvent()">
      </app-advanced-search>
      <div class="row d-flex justify-content-between mt-3">
        <!-- Search Start -->
        <div class="d-flex justify-content-center" style="margin-left: 30px;">
          <!-- Search input -->
          <div class="col-12">
            <div class="form-group row">
              <div class="col-10 pl-1">
                <input type="text" class="form-control" autocomplete="off" placeholder="{{'SEARCH'|translate}}"
                  name='value' aria-label="Search" style="width: 160px;" aria-describedby="addon-wrapping"
                  [(ngModel)]='filterValue' (keyup)='doFilter()'>
              </div>
              <div class="col-2 p-1">
                <i class="fa fa-search fa-lg" aria-hidden="true" (click)='doFilter()'></i>
              </div>
            </div>
          </div>
        </div>
        <!-- Search End-->
        <app-btn-grid class="col" [fileName]="'INTERVENTIONS'|translate" [advencedAdd]='true' [addLink]='"add"'
          [cardView]="false" [relativeStyle]='true' [model]="true" [gridSettings]="gridSettings"
          [service]="interventionService" [predicate]="predicateForQuickSearch" [isExportExcel]="true" *ngIf="hasAddPermission">
        </app-btn-grid>
      </div>
      <kendo-grid [data]="gridSettings.gridData" [pageable]="pagerSettings" [pageSize]="gridSettings.state.take"
        [skip]="gridSettings.state.skip" [sort]="gridSettings.state.sort" [reorderable]="true" [sortable]="true"
        (dataStateChange)="dataStateChange($event)">
        <!-- Customer -->
        <kendo-grid-column [field]="columnsConfig[0].field" [filter]="columnsConfig[0].filter" [filterable]="true"
          [width]="160">
          <ng-template kendoGridHeaderTemplate>
            <span tooltip="{{gridSettings.columnsConfig[0].tooltip|translate}}"
              theme="light">{{gridSettings.columnsConfig[0].title|translate}}</span>
          </ng-template>
          <ng-template kendoGridCellTemplate let-dataItem>
            <div class="row cursor-pointer">
              <div class="col-auto">
                <div class="picture-style d-flex justify-content-center">
                  <img id="ThumbnailWorker" class="imgSize" alt="Illustration des problÃ¨mes de suddation" border="0"
                    [src]="tiersPictureSrc(dataItem) || 'assets/image/placeholder-logo.png'" />
                </div>
              </div>
              <div class="col">
                <div class="row">
                  <span class="font-weight-bold">
                    {{dataItem.TiersName}}
                  </span>
                </div>
                <div class="row">
                  <span class="light-reference">
                    {{dataItem.TiersCode}}
                  </span>
                </div>
              </div>
            </div>
          </ng-template>
        </kendo-grid-column>
        <!-- Model -->
        <kendo-grid-column [field]="columnsConfig[1].field" [filter]="columnsConfig[1].filter" [filterable]="true"
          [width]="160">
          <ng-template kendoGridHeaderTemplate>
            <span tooltip="{{gridSettings.columnsConfig[1].tooltip|translate}}"
              theme="light">{{gridSettings.columnsConfig[1].title|translate}}</span>
          </ng-template>
          <ng-template kendoGridCellTemplate let-dataItem>
            <div class="row cursor-pointer">
              <div class="col-auto">
                <div class="picture-style d-flex justify-content-center">
                  <img id="ThumbnailWorker" class="imgSize" alt="{{'BRAND' | translate}}" border="0"
                    [src]="vehicleBrandPictureSrc(dataItem) || 'assets/image/placeholder-logo.png'" />
                </div>
              </div>
              <div class="col">
                <div class="row">
                  <span class="font-weight-bold" *ngIf="dataItem.VehicleBrandDesignation">
                    {{dataItem.VehicleBrandDesignation}}
                  </span>
                  <span class="font-weight-bold" *ngIf="!dataItem.VehicleBrandDesignation">
                    ---
                  </span>
                </div>
                <div class="row">
                  <span class="light-reference" *ngIf="dataItem.VehicleModelDesignation">
                    {{dataItem.VehicleModelDesignation}}
                  </span>
                  <span class="light-reference" *ngIf="!dataItem.VehicleModelDesignation">
                    ---
                  </span>
                </div>
              </div>
            </div>
          </ng-template>
        </kendo-grid-column>
        <!-- Registration number -->
        <kendo-grid-column [field]="columnsConfig[2].field" [filter]="columnsConfig[2].filter" [filterable]="true"
          [width]="150">
          <ng-template kendoGridHeaderTemplate>
            <span tooltip="{{gridSettings.columnsConfig[2].tooltip|translate}}"
              theme="light">{{gridSettings.columnsConfig[2].title|translate}}</span>
          </ng-template>
          <ng-template kendoGridCellTemplate let-dataItem>
            {{dataItem.VehicleRegistrationNumber}}
          </ng-template>
        </kendo-grid-column>
        <!-- Code -->
        <kendo-grid-column [field]="columnsConfig[3].field" [filter]="columnsConfig[3].filter" [filterable]="true"
          [width]="150">
          <ng-template kendoGridHeaderTemplate>
            <span tooltip="{{gridSettings.columnsConfig[3].tooltip|translate}}"
              theme="light">{{gridSettings.columnsConfig[3].title|translate}}</span>
          </ng-template>
          <ng-template kendoGridCellTemplate let-dataItem="dataItem">
            <span class="pointer intervention-code" (click)="goToAdvancedEdit(dataItem.Id)" theme="light">
              {{dataItem.Code}}
            </span>
          </ng-template>
        </kendo-grid-column>
        <!-- Code Delivery -->
        <kendo-grid-column [field]="columnsConfig[4].field" [filter]="columnsConfig[4].filter" [filterable]="true"
          [width]="160">
          <ng-template kendoGridHeaderTemplate>
            <span tooltip="{{gridSettings.columnsConfig[4].tooltip|translate}}"
              theme="light">{{gridSettings.columnsConfig[4].title|translate}}</span>
          </ng-template>
          <ng-template kendoGridCellTemplate let-dataItem="dataItem">
            <span *ngIf="dataItem.IdDeliveryDocumentNavigation && dataItem.IdDeliveryDocumentNavigation.Code"
              class="pointer intervention-code" (click)="goToEditDelivery(dataItem.IdDeliveryDocumentNavigation)" theme="light">
              {{dataItem.IdDeliveryDocumentNavigation ? dataItem.IdDeliveryDocumentNavigation.Code : '' }}
            </span>
            <span *ngIf="!(dataItem.IdDeliveryDocumentNavigation && dataItem.IdDeliveryDocumentNavigation.Code)" theme="light">
              ---
            </span>
          </ng-template>
        </kendo-grid-column>
        <!-- Code Invoice -->
        <kendo-grid-column [field]="columnsConfig[5].field" [filter]="columnsConfig[5].filter" [filterable]="true"
          [width]="160">
          <ng-template kendoGridHeaderTemplate>
            <span tooltip="{{gridSettings.columnsConfig[5].tooltip|translate}}"
              theme="light">{{gridSettings.columnsConfig[5].title|translate}}</span>
          </ng-template>
          <ng-template kendoGridCellTemplate let-dataItem="dataItem">
            <span *ngIf="dataItem.IdInvoiceDocumentNavigation && dataItem.IdInvoiceDocumentNavigation.Code"
              class="pointer intervention-code" (click)="goToEditInvoice(dataItem.IdInvoiceDocumentNavigation)" theme="light">
              {{dataItem.IdInvoiceDocumentNavigation ? dataItem.IdInvoiceDocumentNavigation.Code : '' }}
            </span>
            <span *ngIf="!(dataItem.IdInvoiceDocumentNavigation && dataItem.IdInvoiceDocumentNavigation.Code)" theme="light">
              ---
            </span>
          </ng-template>
        </kendo-grid-column>
        <!-- InterventionDate -->
        <kendo-grid-column [field]="columnsConfig[6].field" [filter]="columnsConfig[6].filter" [filterable]="true"
          [width]="150">
          <ng-template kendoGridHeaderTemplate>
            <span tooltip="{{gridSettings.columnsConfig[6].tooltip|translate}}"
              theme="light">{{gridSettings.columnsConfig[6].title|translate}}</span>
          </ng-template>
          <ng-template kendoGridCellTemplate let-dataItem>
            <span *ngIf="dataItem.InterventionDate">
              {{dataItem.InterventionDate | date : dateFormat}}
            </span>
            <span *ngIf="!dataItem.InterventionDate">
              ---
            </span>
          </ng-template>
        </kendo-grid-column>
        <!-- Status -->
        <kendo-grid-column [field]="columnsConfig[7].field" [filter]="columnsConfig[7].filter" [filterable]="true"
          [width]="140">
          <ng-template kendoGridHeaderTemplate>
            <span tooltip="{{gridSettings.columnsConfig[7].tooltip|translate}}"
              theme="light">{{gridSettings.columnsConfig[7].title|translate}}</span>
          </ng-template>
          <ng-template kendoGridCellTemplate let-dataItem='dataItem'>
            <span *ngIf="dataItem.Status === interventionState.Open" class="badge badge-primary">
              {{'OPEN'|translate}} </span>
            <span *ngIf="dataItem.Status === interventionState.InProgress" class="badge badge-success">
              {{'INPROGRESS'|translate}}
            </span>
            <span *ngIf="dataItem.Status === interventionState.Completed" class="badge badge-completed">
              {{'COMPLETED'|translate}}
            </span>
          </ng-template>
        </kendo-grid-column>

        <!-- Command-->
        <kendo-grid-command-column [width]="120">
          <ng-template kendoGridHeaderTemplate>
            <span tooltip="{{'ACTIONS' | translate}}" theme="light">{{'ACTIONS' | translate}}</span>
          </ng-template>
          <ng-template kendoGridCellTemplate let-isNew="isNew" let-dataItem="dataItem">
            <span tooltip="{{'UPDATE' | translate}}" theme="light">
              <i class="las la-pen cursor-pointer edit-pencil la-lg ng-star-inserted" *ngIf="hasUpdatePermission || hasShowPermission"
                (click)="goToAdvancedEdit(dataItem.Id)"></i>
            </span>
            <span tooltip="{{'DELETE' | translate}}" theme="light">
              <i class="fa fa-trash-o la-lg cursor-pointer text-danger ng-star-inserted" *ngIf="hasDeletePermission"
                (click)="removeHandler(dataItem)"></i>
            </span>
          </ng-template>
        </kendo-grid-command-column>
      </kendo-grid>
    </div>
  </div>
</div>

<div class="col-lg-12 col-sm-12 col-md-12">
  <app-advanced-search [filtreFieldsColumns]="filterFieldsColumns" [filtreFieldsInputs]="filterFieldsInputs"
    (filtrePredicateToSend)="advancedFilterPredicateChange($event)"
    (filterFieldsInputsChange)="filterFieldsInputsChange($event)" (searchClickEvent)="searchClick()"
    (resetClickEvent)="resetClickEvent()">
  </app-advanced-search>
  <kendo-grid #grid [data]="gridSettings.gridData" [pageable]="pagerSettings" [pageSize]="gridSettings.state.take"
    [skip]="gridSettings.state.skip" [sort]="gridSettings.state.sort" [reorderable]="true" [sortable]="true"
    (dataStateChange)="dataStateChange($event)" (edit)="editHandler($event)" (save)="saveHandler($event)"
    (cancel)="cancelHandler($event)">
    <!-- Customer -->
    <kendo-grid-column [field]="columnsConfig[0].field" [filter]="columnsConfig[0].filter" [filterable]="true"
      [width]="160">
      <ng-template kendoGridHeaderTemplate>
        <span tooltip="{{gridSettings.columnsConfig[0].tooltip|translate}}"
          theme="light">{{gridSettings.columnsConfig[0].title|translate}}</span>
      </ng-template>
      <ng-template kendoGridCellTemplate let-dataItem>
        <div class="row cursor-pointer">
          <div class="col-auto">
            <div class="picture-style d-flex justify-content-center">
              <img id="ThumbnailCustomer" class="imgSize" border="0"
                [src]="tiersPictureSrc(dataItem) || 'assets/image/placeholder-logo.png'" />
            </div>
          </div>
          <div class="col">
            <div class="row">
              <span class="font-weight-bold">
                {{dataItem.TiersName}}
              </span>
            </div>
            <div class="row">
              <span class="light-reference">
                {{dataItem.TiersCode}}
              </span>
            </div>
          </div>
        </div>
      </ng-template>
    </kendo-grid-column>
    <!-- LoanDate -->
    <kendo-grid-column [field]="columnsConfig[1].field" [filter]="columnsConfig[1].filter" [filterable]="true"
      [width]="150">
      <ng-template kendoGridHeaderTemplate>
        <span tooltip="{{gridSettings.columnsConfig[1].tooltip|translate}}"
          theme="light">{{gridSettings.columnsConfig[1].title|translate}}</span>
      </ng-template>
      <ng-template kendoGridCellTemplate let-dataItem>
        <span *ngIf="dataItem.LoanDate">
          {{dataItem.LoanDate | date : dateFormat}}
        </span>
        <span *ngIf="!dataItem.LoanDate">
          ---
        </span>
      </ng-template>
    </kendo-grid-column>
    <!-- ExpectedReturnDate -->
    <kendo-grid-column [field]="columnsConfig[2].field" [filter]="columnsConfig[2].filter" [filterable]="true"
      [width]="150">
      <ng-template kendoGridHeaderTemplate>
        <span tooltip="{{gridSettings.columnsConfig[2].tooltip|translate}}"
          theme="light">{{gridSettings.columnsConfig[2].title|translate}}</span>
      </ng-template>
      <ng-template kendoGridCellTemplate let-dataItem>
        <span *ngIf="dataItem.ExpectedReturnDate">
          {{dataItem.ExpectedReturnDate | date : dateFormat}}
        </span>
        <span *ngIf="!dataItem.ExpectedReturnDate">
          ---
        </span>
      </ng-template>
    </kendo-grid-column>
    <!-- RealReturnDate -->
    <kendo-grid-column [field]="columnsConfig[3].field" [filter]="columnsConfig[3].filter" [filterable]="true"
      [width]="150">
      <ng-template kendoGridHeaderTemplate>
        <span tooltip="{{gridSettings.columnsConfig[3].tooltip|translate}}"
          theme="light">{{gridSettings.columnsConfig[3].title|translate}}</span>
      </ng-template>
      <ng-template kendoGridCellTemplate let-dataItem>
        <span *ngIf="dataItem.RealReturnDate">
          {{dataItem.RealReturnDate | date : dateFormat}}
        </span>
        <span *ngIf="!dataItem.RealReturnDate">
          ---
        </span>
      </ng-template>
      <ng-template kendoGridEditTemplate let-dataItem="dataItem" let-formGroup="formGroup">
        <div class="col-lg-8 col-md-8 col-sm-8">
          <div [formGroup]="formGroup">
            <kendo-datepicker [format]="dateFormat" formControlName="RealReturnDate" class="form-control">
              <kendo-datepicker-messages today="{{ 'TODAY' | translate}}" toggle="Cambiar calendario">
              </kendo-datepicker-messages>
            </kendo-datepicker>
          </div>
          <i #anchor></i>
          <app-control-message-grid-cell [group]="formGroup" [anchor]="anchor" controlName="RealReturnDate">
          </app-control-message-grid-cell>
        </div>
      </ng-template>
    </kendo-grid-column>
    <!-- Status -->
    <kendo-grid-column [field]="columnsConfig[4].field" [filter]="columnsConfig[4].filter" [filterable]="true"
      [width]="130">
      <ng-template kendoGridHeaderTemplate>
        <span tooltip="{{gridSettings.columnsConfig[4].tooltip|translate}}"
          theme="light">{{gridSettings.columnsConfig[4].title|translate}}</span>
      </ng-template>
      <ng-template kendoGridCellTemplate let-dataItem>
        <span *ngIf="dataItem.Status === interventionLoanVehicleStatusEnum.InGoodCondition"
          tooltip="{{'IN_GOOD_CONDITION' | translate}}">
          <i class="fa fa-check in-good-condition-icon" aria-hidden="true"></i>
        </span>
        <span *ngIf="dataItem.Status === interventionLoanVehicleStatusEnum.InLoan" tooltip="{{'IN_LOAN' | translate}}">
          <i class="fa fa-lock in-loan-icon" aria-hidden="true"></i>
        </span>
        <span *ngIf="dataItem.Status === interventionLoanVehicleStatusEnum.WithDamage"
          tooltip="{{'WITH_DAMAGE' | translate}}">
          <i class="fa fa-picture-o with-damage-icon" aria-hidden="true" (click)="openLoanVehiclePicture(dataItem)"></i>
        </span>
      </ng-template>
      <ng-template kendoGridEditTemplate let-dataItem="dataItem" let-formGroup="formGroup">
        <div class="row">
          <div class="col-lg-8 col-md-8 col-sm-8">
            <app-intervention-loan-vehicle-status-dropdown [group]="formGroup">
            </app-intervention-loan-vehicle-status-dropdown>
            <i #anchor></i>
            <app-control-message-grid-cell [group]="formGroup" [anchor]="anchor" controlName="Status">
            </app-control-message-grid-cell>
          </div>
        </div>
      </ng-template>
    </kendo-grid-column>
    <!-- Command-->
    <kendo-grid-command-column [width]="80">
      <ng-template kendoGridHeaderTemplate>
        <span tooltip="{{'ACTIONS' | translate}}" theme="light">{{'ACTIONS' | translate}}</span>
      </ng-template>
      <ng-template kendoGridCellTemplate let-isNew="isNew" let-dataItem="dataItem">
        <button kendoGridEditCommand tooltip="{{'UPDATE' | translate}}" class='noPadding btn-Add' type="button" *ngIf="hasUpdatePermission">
          <i class="las la-pen cursor-pointer edit-pencil la-lg ng-star-inserted" aria-hidden="true"></i>
        </button>
        <button kendoGridSaveCommand tooltip="{{'SAVE' | translate}}" class='noPadding btn-Add' type="button" *ngIf="hasUpdatePermission">
          <i class="fa fa-check fa-lg AddIcon" aria-hidden="true"></i>
        </button>
        <button kendoGridCancelCommand tooltip="{{'CANCEL' | translate}}" class="noPadding btn-Add k-button" *ngIf="hasUpdatePermission"
          type="button">
          <i class="fa fa-ban fa-lg" style="color: #E91E63;" aria-hidden="true"></i>
        </button>
      </ng-template>
    </kendo-grid-command-column>
  </kendo-grid>
</div>
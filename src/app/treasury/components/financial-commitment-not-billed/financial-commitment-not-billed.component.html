<div class="col-lg-12 col-md-12 col-sm-122">
  <div class="row">
    <div class="card" style="width:100%; border: 0px;">
      <div class="card-content">
        <!--Begin card body-->
        <div class="card-body">
          <div class="row d-flex justify-content-between mt-3">
            <div class="col-lg-3 col-md-12">
              <label class="col-lg-12 col-md-12 col-sm-12">
                {{(tiersType == tiersTypeEnum.Customer ? 'CUSTOMER' : 'SUPPLIER')|translate}}</label>
              <app-supplier-dropdown [type]="tiersType" (Selected)="emitSupplier($event)" #supplierViewChild
                                     [selectedValue]="selectedTiers" [disabled]=supplierDropdownDisabled
                                     [hideAddBtn]="true">
              </app-supplier-dropdown>
            </div>
            <div class="d-flex float-right" style="margin-top: 25px;">
              <button *ngIf="(displayAddButton && hasAddCustomerSettlementPermission && tiersType == tiersTypeEnum.Customer) || (displayAddButton && hasAddSupplierSettlementPermission && tiersType == tiersTypeEnum.Supplier)"
                      tooltip="{{'ADD_SETTLEMENT' | translate}}" data-placement="bottom"
                      class="form-group btn btn-sm k-float-right addBtn ml-3 mr-2" type="button" tabindex="0"
                      (click)="AddNewSettlement()">
                <i class="fa fa-plus fa-lg addBtn"></i>
                <span class="addBtn">&nbsp;{{'ADD' | translate}}</span>
              </button>

              <i *ngIf="tiersType == tiersTypeEnum.Customer && hasSendReminderMailPermission"
                 tooltip="{{getToolipValueForReminderMail()}}" class="cursor-pointer fa fa-envelope la-2x"
                 (click)="sendReminderMail()" style="color: #20a8d8;" tabindex="0"></i>

              <i *ngIf="listFinancialCommitmentSelected.length" class="las la-ellipsis-v la-2x mt-1 " aria-hidden="true"
                 id="dropdownMenuButton" data-toggle="dropdown" aria-haspopup="true"
                 aria-expanded="false"></i>
              <div class="dropdown-menu dpMenu" id="action_grid_toggle" aria-labelledby="dropdownMenuButton">
                <a class="dropdown-item dpItem" (click)="openSelectedFinancialCommitments()">
                  {{'SELECTED_DOCUMENTS' | translate}} ({{listFinancialCommitmentSelected.length}})
                </a>
              </div>

            </div>
          </div>

          <!-- Kendo grid start-->
          <kendo-grid [data]="gridSettings.gridData" [pageable]="pagerSettings" [pageSize]="gridSettings.state.take"
                      [skip]="gridSettings.state.skip" [sortable]="true" [sort]="gridSettings.state.sort"
                      [reorderable]="true"
                      (dataStateChange)="dataStateChange($event)" [filterable]="true"
                      [filter]="gridSettings.state.filter" #grid>

            <ng-template kendoGridToolbarTemplate>
              <div class="row" style="float :right; margin-right: 4px;">
                <app-btn-grid [advencedAdd]='false' [add]='false' [export]='true' [idForExportFile]="idForExportFile"
                              style="margin-top: -5%;    display: inline-flex;"></app-btn-grid>
              </div>
            </ng-template>
            <!-- CheckBox start -->
            <kendo-grid-column [width]="70" [field]="'field'" [filterable]="true" *ngIf="!disableCheckBox">
              <ng-template kendoGridHeaderTemplate>

              </ng-template>
              <ng-template kendoGridFilterCellTemplate let-filter="filter" let-column="column">
                <span *ngIf="sameTiers && (gridSettings.gridData.data.length > 0)"
                      (click)="selectAllFinancialCommitment()" class="button-checkbox">
                  <button type="button" class="action-btn bill-default-btn" data-color="primary"
                          tooltip="{{'SELECT_CURRENT_PAGE' | translate}}">
                    <i class="fa fa-check-square bill-icon-style"
                       *ngIf="checkSamePageSelectedFinancialCommitmentState()===documentCheckedState.Checked"></i>
                    <i class="fa fa-minus-square bill-icon-style"
                       *ngIf="checkSamePageSelectedFinancialCommitmentState()===documentCheckedState.Intermediate"></i>
                    <i class="fa fa-square-o bill-icon-style"
                       *ngIf="checkSamePageSelectedFinancialCommitmentState()===documentCheckedState.NotChecked"></i>
                  </button>
                </span>
              </ng-template>
              <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                <span (click)="selectFinancialCommitment(dataItem)" class="button-checkbox">
                  <button type="button" class="action-btn bill-default-btn" data-color="primary"
                          onkeydown="return false;">
                    <i *ngIf="!dataItem.IsChecked" class="fa fa-square-o bill-icon-style"></i>
                    <i *ngIf="dataItem.IsChecked" class="fa fa-check-square bill-icon-style"></i>
                  </button>
                </span>
              </ng-template>
            </kendo-grid-column>
            <!-- CheckBox end -->

            <!--Code start-->
            <kendo-grid-column [field]="gridSettings.columnsConfig[0].field" [width]="200"
                               [title]="gridSettings.columnsConfig[0].title | translate">
              <ng-template kendoGridHeaderTemplate>
                <span [tooltip]="getCodeTitle() | translate"
                      theme="light">{{gridSettings.columnsConfig[0].title|translate}}</span>
              </ng-template>
              <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                <span class="cursor-pointer doc-code" style="font-size: 0.9em;"
                *ngIf="(!isAsset && hasShowSalesInvoicePermission && tiersType == tiersTypeEnum.Customer) || (isAsset && hasShowSalesInvoiceAssetsPermission && tiersType == tiersTypeEnum.Customer)
                  || (!isAsset && hasShowPurchaseInvoicePermission && tiersType == tiersTypeEnum.Supplier) || (isAsset && hasShowPurchaseAssetPermission && tiersType == tiersTypeEnum.Supplier)"
                      (click)="showDocument(dataItem.IdDocumentNavigation)">&nbsp;
                  {{dataItem.Code}}
                </span>
                <span *ngIf="(!isAsset && !hasShowSalesInvoicePermission && tiersType == tiersTypeEnum.Customer) || (isAsset && !hasShowSalesInvoiceAssetsPermission && tiersType == tiersTypeEnum.Customer)
                  || (!isAsset && !hasShowPurchaseInvoicePermission && tiersType == tiersTypeEnum.Supplier) || (isAsset && !hasShowPurchaseAssetPermission && tiersType == tiersTypeEnum.Supplier)"
                      style="font-size: 0.9em;">&nbsp;
                  {{dataItem.Code}}
                </span>
              </ng-template>
              <ng-template kendoGridFooterTemplate>
                <div style=" font-weight:bold;color: #4c9aae; font-size: 16px; padding-top: 7px;
                    padding-bottom: 7px;"> {{'TOTAL'| translate}}</div>
              </ng-template>
            </kendo-grid-column>
            <!--Code end-->
            <!--Client start-->
            <kendo-grid-column [field]="gridSettings.columnsConfig[1].field" [title]="getTiersTitle() | translate"
                               [width]="190">
              <ng-template kendoGridHeaderTemplate>
                <span [tooltip]="getTiersTitle() | translate"
                      theme="light">{{getTiersTitle()|translate}}</span>
              </ng-template>
            </kendo-grid-column>
            <!--Client end-->
            <!--DocumentDate start-->
            <kendo-grid-column [field]="gridSettings.columnsConfig[2].field"
                               [title]="gridSettings.columnsConfig[2].title | translate" filter="date" [width]="190"
                               filter="date">
              <ng-template kendoGridHeaderTemplate>
                <span tooltip="{{gridSettings.columnsConfig[2].tooltip|translate}}"
                      theme="light">{{gridSettings.columnsConfig[2].title|translate}}</span>
              </ng-template>
              <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                <div *ngIf="dataItem.IdDocumentNavigation.DocumentDate">
                  {{dataItem.IdDocumentNavigation.DocumentDate| date: dateFormat}}
                </div>
                <div *ngIf="!dataItem.IdDocumentNavigation.DocumentDate">
                  -
                </div>
              </ng-template>
            </kendo-grid-column>
            <!--DocumentDate end-->
            <!--Commitment Date start-->
            <kendo-grid-column *ngIf="!isAsset" [field]="gridSettings.columnsConfig[3].field"
                               [title]="gridSettings.columnsConfig[3].title | translate" filter="date" [width]="190"
                               filter="date">
              <ng-template kendoGridHeaderTemplate>
                <span tooltip="{{gridSettings.columnsConfig[3].tooltip|translate}}"
                      theme="light">{{gridSettings.columnsConfig[3].title|translate}}</span>
              </ng-template>
              <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                {{dataItem.CommitmentDate | date: dateFormat}}
                <span *ngIf="!isUpdateMode && (dataItem.CommitmentDate <= currentDate)"
                      tooltip="{{'EXCEEDED' | translate}}" style="margin-left: 12px;">
                  <i class="fa fa-hourglass-end" style="color: #d42222;"></i>
                </span>
                <span
                  *ngIf="!isUpdateMode && (!(dataItem.CommitmentDate <= currentDate) && (dataItem.CommitmentDate <= deadLineInTreeDays))"
                  tooltip="{{'NEAR' | translate}}" style="margin-left: 12px;">
                  <i class="fa fa-hourglass-half" style="color: rgba(255, 125, 4, 0.897);"></i>
                </span>
              </ng-template>
            </kendo-grid-column>
            <!--Commitment Date end-->
            <!--DocumentTtcpriceWithCurrency start-->
            <kendo-grid-column [field]="gridSettings.columnsConfig[4].field"
                               [title]="gridSettings.columnsConfig[4].title | translate" filter="numeric" [width]="250"
                               [style]='{"font-family": "Arial, Helvetica, serif",
                        "color": "#505253", "text-align":"right", "padding-right": "3%"}'
                               [headerStyle]="{'text-align':'right','padding-right':'3%'}">
              <ng-template kendoGridHeaderTemplate>
                <span tooltip="{{gridSettings.columnsConfig[4].tooltip|translate}}"
                      theme="light">{{gridSettings.columnsConfig[4].title|translate}}</span>
              </ng-template>
              <ng-template kendoGridCellTemplate let-dataItem="dataItem" *ngIf="tiersType == tiersTypeEnum.Customer">
                <span>
                  {{dataItem.AmountWithCurrency.toLocaleString(language, {
                  minimumFractionDigits: dataItem.IdCurrencyNavigation.Precision,
                  style: 'currency', currency: dataItem.IdCurrencyNavigation.Code, currencyDisplay: 'code'
                })}}
                </span>
              </ng-template>
              <ng-template kendoGridCellTemplate let-dataItem="dataItem" *ngIf="tiersType == tiersTypeEnum.Supplier">
                <span>
                  {{dataItem.AmountWithCurrency.toLocaleString(language, {
                  minimumFractionDigits: dataItem.IdCurrencyNavigation.Precision,
                  style: 'currency', currency: dataItem.IdCurrencyNavigation.Code, currencyDisplay: 'code'
                })}}
                </span>
              </ng-template>
              <ng-template kendoGridFooterTemplate>
                <div style="text-align: right;font-weight:bold;font-size: 16px;margin-right: 22%;"
                     *ngIf="tiersType == tiersTypeEnum.Customer && userCurrency">
                  <span>
                    {{TotalTtcAmount.toLocaleString(language, {
                    minimumFractionDigits: userCurrency.Precision,
                    style: 'currency', currency: userCurrency.Code, currencyDisplay: 'code'
                  })}}
                  </span>
                </div>
                <div style="text-align: right;font-weight:bold;font-size: 16px;margin-right: 22%;"
                     *ngIf="tiersType == tiersTypeEnum.Supplier && userCurrency">
                  <span>
                    {{TotalTtcAmount.toLocaleString(language, {
                    minimumFractionDigits: userCurrency.Precision,
                    style: 'currency', currency: userCurrency.Code, currencyDisplay: 'code'
                  })}}
                  </span>
                </div>
              </ng-template>
            </kendo-grid-column>
            <!--TtcpriceWithCurrency end-->
            <!-- Withholding Start-->
            <kendo-grid-column *ngIf="!isAsset && companyWithholdingTax" [field]="gridSettings.columnsConfig[5].field"
                               [title]="gridSettings.columnsConfig[5].title | translate" [width]="200" filter="numeric"
                               [style]='{"font-family": "Arial, Helvetica, serif", "color": "#505253", "text-align":"right","padding-right": "3%"}'
                               [headerStyle]="{'text-align':'right','padding-right':'3%'}">
              <ng-template kendoGridHeaderTemplate>
                <span tooltip="{{gridSettings.columnsConfig[5].tooltip|translate}}"
                      theme="light">{{gridSettings.columnsConfig[5].title|translate}}</span>
              </ng-template>
              <ng-template kendoGridCellTemplate let-dataItem="dataItem" style="font-family: Arial, Helvetica;">
                <span *ngIf="dataItem.WithholdingTaxWithCurrency">
                  <span *ngIf="tiersType === tiersTypeEnum.Customer">
                    {{dataItem.WithholdingTaxWithCurrency.toLocaleString(language, {
                    minimumFractionDigits: dataItem.IdCurrencyNavigation.Precision,
                    style: 'currency', currency: dataItem.IdCurrencyNavigation.Code, currencyDisplay: 'code'
                  })}}
                  </span>
                  <span *ngIf="tiersType === tiersTypeEnum.Supplier">
                    {{dataItem.WithholdingTaxWithCurrency.toLocaleString(language, {
                    minimumFractionDigits: dataItem.IdCurrencyNavigation.Precision,
                    style: 'currency', currency: dataItem.IdCurrencyNavigation.Code, currencyDisplay: 'code'
                  })}}
                  </span>
                </span>
                <span *ngIf="!dataItem.WithholdingTaxWithCurrency"> - </span>
              </ng-template>
            </kendo-grid-column>
            <!-- Withholding End-->
            <!-- RemainingWithholdingTaxWithCurrency Tax Start -->
            <kendo-grid-column *ngIf="!isAsset && companyWithholdingTax" [field]="gridSettings.columnsConfig[6].field"
                               [title]="gridSettings.columnsConfig[6].title | translate" [width]="230" filter="numeric"
                               [style]='{"font-family": "Arial, Helvetica, serif", "color": "#505253", "text-align":"right","padding-right": "3%"}'
                               [headerStyle]="{'text-align':'right','padding-right':'3%'}">
              <ng-template kendoGridHeaderTemplate>
                <span tooltip="{{gridSettings.columnsConfig[6].tooltip|translate}}"
                      theme="light">{{gridSettings.columnsConfig[6].title|translate}}</span>
              </ng-template>
              <ng-template kendoGridHeaderTemplate>
                <span tooltip="{{gridSettings.columnsConfig[6].tooltip|translate}}"
                      theme="light">{{gridSettings.columnsConfig[6].title|translate}}</span>
              </ng-template>
              <ng-template kendoGridCellTemplate let-column let-columnIndex="columnIndex" let-dataItem="dataItem"
                           style="font-family: Arial, Helvetica;">
                <span *ngIf="(dataItem.RemainingWithholdingTaxWithCurrency + dataItem.RemainingVatWithholdingTaxWithCurrency)">
                  <span *ngIf="tiersType === tiersTypeEnum.Customer">
                    {{(dataItem.RemainingWithholdingTaxWithCurrency + dataItem.RemainingVatWithholdingTaxWithCurrency).toLocaleString(language, {
                    minimumFractionDigits: dataItem.IdCurrencyNavigation.Precision,
                    style: 'currency', currency: dataItem.IdCurrencyNavigation.Code, currencyDisplay: 'code'
                  })}}
                  </span>
                  <span *ngIf="tiersType === tiersTypeEnum.Supplier">
                    {{(dataItem.RemainingWithholdingTaxWithCurrency + dataItem.RemainingVatWithholdingTaxWithCurrency).toLocaleString(language, {
                    minimumFractionDigits: dataItem.IdCurrencyNavigation.Precision,
                    style: 'currency', currency: dataItem.IdCurrencyNavigation.Code, currencyDisplay: 'code'
                  })}}
                  </span>
                </span>
                <span *ngIf="!(dataItem.RemainingVatWithholdingTaxWithCurrency + dataItem.RemainingWithholdingTaxWithCurrency)"> - </span>
              </ng-template>
            </kendo-grid-column>
            <!-- RemainingWithholdingTaxWithCurrency Tax End -->
            <!--AmountWithoutWithholdingTaxWithCurrency start-->
            <kendo-grid-column *ngIf="!isAsset && companyWithholdingTax" [field]="gridSettings.columnsConfig[7].field"
                               [title]="gridSettings.columnsConfig[7].title | translate" [width]="200" filter="numeric"
                               [style]='{"font-family": "Arial, Helvetica, serif", "color": "#505253", "text-align":"right","padding-right": "3%"}'
                               [headerStyle]="{'text-align':'right','padding-right':'3%'}">
              <ng-template kendoGridHeaderTemplate>
                <span tooltip="{{gridSettings.columnsConfig[7].tooltip|translate}}"
                      theme="light">{{gridSettings.columnsConfig[7].title|translate}}</span>
              </ng-template>
              <ng-template kendoGridCellTemplate let-dataItem="dataItem">
                <span
                  *ngIf="dataItem.AmountWithoutWithholdingTaxWithCurrency && dataItem.AmountWithoutWithholdingTaxWithCurrency > 0">
                  <span *ngIf="tiersType === tiersTypeEnum.Customer">
                    {{dataItem.AmountWithoutWithholdingTaxWithCurrency.toLocaleString(language, {
                    minimumFractionDigits: dataItem.IdCurrencyNavigation.Precision,
                    style: 'currency', currency: dataItem.IdCurrencyNavigation.Code, currencyDisplay: 'code'
                  })}}
                  </span>
                  <span *ngIf="tiersType === tiersTypeEnum.Supplier">
                    {{dataItem.AmountWithoutWithholdingTaxWithCurrency.toLocaleString(language, {
                    minimumFractionDigits: dataItem.IdCurrencyNavigation.Precision,
                    style: 'currency', currency: dataItem.IdCurrencyNavigation.Code, currencyDisplay: 'code'
                  })}}
                  </span>
                </span>
                <span
                  *ngIf="!dataItem.AmountWithoutWithholdingTaxWithCurrency || dataItem.AmountWithoutWithholdingTaxWithCurrency === 0">
                  - </span>
              </ng-template>
            </kendo-grid-column>
            <!--AmountWithoutWithholdingTaxWithCurrency end-->
            <!--RemainingAmountWithCurrency start-->
            <kendo-grid-column [field]="gridSettings.columnsConfig[8].field"
                               [title]="gridSettings.columnsConfig[8].title | translate" filter="numeric" [width]="250"
                               [style]='{"font-family": "Arial, Helvetica, serif", "color": "#505253", "text-align": "right","padding-right": "3%"}'
                               [headerStyle]="{'text-align':'right','padding-right':'3%'}">
              <ng-template kendoGridHeaderTemplate>
                <span tooltip="{{gridSettings.columnsConfig[8].tooltip|translate}}"
                      theme="light">{{gridSettings.columnsConfig[8].title|translate}}</span>
              </ng-template>
              <ng-template kendoGridCellTemplate let-dataItem="dataItem" *ngIf="tiersType == tiersTypeEnum.Customer">
                <span>
                  {{dataItem.RemainingAmountWithCurrency.toLocaleString(language, {
                  minimumFractionDigits: dataItem.IdCurrencyNavigation.Precision,
                  style: 'currency', currency: dataItem.IdCurrencyNavigation.Code, currencyDisplay: 'code'
                })}}
                </span>
                <i *ngIf="dataItem.AmountWithoutWithholdingTaxWithCurrency !== dataItem.RemainingAmountWithCurrency"
                   class="fa fa-info-circle fa-lg" style="color:#4c9aae;cursor: pointer;" aria-hidden="true"
                   (click)="showFinancialCommitmentPaymentDetails(dataItem.Id)"></i>
              </ng-template>
              <ng-template kendoGridCellTemplate let-dataItem="dataItem" *ngIf="tiersType == tiersTypeEnum.Supplier">
                <span>
                  {{dataItem.RemainingAmountWithCurrency.toLocaleString(language, {
                  minimumFractionDigits: dataItem.IdCurrencyNavigation.Precision,
                  style: 'currency', currency: dataItem.IdCurrencyNavigation.Code, currencyDisplay: 'code'
                })}}
                </span>
                <i *ngIf="dataItem.AmountWithoutWithholdingTaxWithCurrency !== dataItem.RemainingAmountWithCurrency"
                   class="fa fa-info-circle fa-lg" style="color:#4c9aae;cursor: pointer;" aria-hidden="true"
                   (click)="showFinancialCommitmentPaymentDetails(dataItem.Id)"></i>
              </ng-template>
              <ng-template kendoGridFooterTemplate>
                <div style="text-align: right;font-weight:bold;font-size: 16px;margin-right: 22%;"
                     *ngIf="tiersType == tiersTypeEnum.Customer && userCurrency">
                  {{TotalRemainingAmount.toLocaleString(language, {
                  minimumFractionDigits: userCurrency.Precision,
                  style: 'currency', currency: userCurrency.Code, currencyDisplay: 'code'
                })}}
                </div>
                <div style="text-align: right;font-weight:bold;font-size: 16px;margin-right: 22%;"
                     *ngIf="tiersType == tiersTypeEnum.Supplier && userCurrency">
                  {{TotalRemainingAmount.toLocaleString(language, {
                  minimumFractionDigits: userCurrency.Precision,
                  style: 'currency', currency: userCurrency.Code, currencyDisplay: 'code'
                })}}
                </div>
              </ng-template>
            </kendo-grid-column>
            <!--RemainingAmountWithCurrency end-->
            <!--grid pdf & excel-->
            <app-grid-export [gridSettings]="gridSettings" fileName="{{ fileExportname |translate}}" pdf="true"
                             excel="false" [service]="customerOutstandingService" [predicate]="predicateForExport"
                             [api]="apiForExport">
            </app-grid-export>
            <!--end grid pdf & excel-->

          </kendo-grid>
          <!-- Kendo grid end-->
        </div>
      </div>
    </div>
  </div>
</div>
